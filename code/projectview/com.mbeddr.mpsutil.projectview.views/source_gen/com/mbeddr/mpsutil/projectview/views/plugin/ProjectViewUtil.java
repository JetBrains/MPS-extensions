package com.mbeddr.mpsutil.projectview.views.plugin;

/*Generated by MPS */

import java.util.Map;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import jetbrains.mps.smodel.Language;
import jetbrains.mps.ide.actions.LanguageActions_ActionGroup;
import jetbrains.mps.project.Solution;
import jetbrains.mps.ide.actions.SolutionActions_ActionGroup;
import jetbrains.mps.project.DevKit;
import jetbrains.mps.ide.actions.DevkitActions_ActionGroup;
import jetbrains.mps.smodel.Generator;
import jetbrains.mps.ide.actions.GeneratorActions_ActionGroup;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.ide.actions.NodeActions_ActionGroup;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.ide.actions.ModelActions_ActionGroup;
import jetbrains.mps.project.IProject;
import jetbrains.mps.ide.actions.ProjectActions_ActionGroup;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.smodel.SModelStereotype;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.project.Project;
import jetbrains.mps.project.AbstractModule;
import java.util.Collections;
import jetbrains.mps.project.StandaloneMPSProject;
import org.apache.commons.lang3.StringUtils;
import jetbrains.mps.vfs.IFile;

public class ProjectViewUtil {

  private static Map<Class, String> actionGroupsIds = MapSequence.fromMap(new HashMap<Class, String>());

  static {
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(Language.class, LanguageActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(Solution.class, SolutionActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(DevKit.class, DevkitActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(Generator.class, GeneratorActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(SNode.class, NodeActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(SModel.class, ModelActions_ActionGroup.ID);
    MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).put(IProject.class, ProjectActions_ActionGroup.ID);
  }

  public static String getActionGroupId(Object object) {
    return getActionGroupId(object.getClass());
  }

  public static String getActionGroupId(Class clazz) {
    if (clazz == null) {
      return null;
    }
    if (MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).containsKey(clazz)) {
      return MapSequence.fromMap(ProjectViewUtil.actionGroupsIds).get(clazz);
    }
    for (Class<?> intf : clazz.getInterfaces()) {
      String result = getActionGroupId(intf);
      if (result != null) {
        return result;
      }
    }
    return getActionGroupId(clazz.getSuperclass());
  }

  public static Iterable<SModel> getUtilModels(Language language) {
    return Sequence.fromIterable(((Iterable<SModel>) language.getModels())).where((it) -> isEmptyString(SModelStereotype.getStereotype(it))).where((it) -> Language.getModelAspect(it) == null);
  }

  public static Iterable<String> getFolders(SModule module, Project project) {
    if (check_xwzga8_a0a0l(as_xwzga8_a0a0a0l(module, AbstractModule.class)) == null) {
      return Sequence.fromIterable(Collections.<String>emptyList());
    }

    String path = check_xwzga8_a0c0l(as_xwzga8_a0a0c0l(project, StandaloneMPSProject.class), module);
    if (path == null) {
      return Sequence.fromIterable(Collections.<String>emptyList());
    }

    return Sequence.fromArray(StringUtils.split(path, '.'));
  }
  private static IFile check_xwzga8_a0a0l(AbstractModule checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getDescriptorFile();
    }
    return null;
  }
  private static String check_xwzga8_a0c0l(StandaloneMPSProject checkedDotOperand, SModule module) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getFolderFor(module);
    }
    return null;
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }
  private static <T> T as_xwzga8_a0a0a0l(Object o, Class<T> type) {
    return (type.isInstance(o) ? (T) o : null);
  }
  private static <T> T as_xwzga8_a0a0c0l(Object o, Class<T> type) {
    return (type.isInstance(o) ? (T) o : null);
  }
}
