package com.mbeddr.mpsutil.grammarcells.runtime;

/*Generated by MPS */

import jetbrains.mps.smodel.action.AbstractSubstituteAction;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.action.IChildNodeSetter;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.smodel.action.SNodeFactoryOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;

public class FlagSubstituteAction extends AbstractSubstituteAction {

  private SNode myParentNode;
  private SNode myNodeToReplace;
  private SAbstractConcept myOutputConcept;
  private SProperty myProperty;
  private String myMatchingText;
  private IChildNodeSetter myChildSetter;

  public FlagSubstituteAction(SNode parentNode, SNode nodeToReplace, SAbstractConcept outputConcept, SProperty property, String matchingText, IChildNodeSetter childSetter) {
    super(parentNode);
    myParentNode = parentNode;
    myNodeToReplace = nodeToReplace;
    myOutputConcept = outputConcept;
    myProperty = property;
    myMatchingText = matchingText;
    myChildSetter = childSetter;
  }

  public String getDescriptionText(String pattern) {
    return myOutputConcept.getName();
  }

  public String getMatchingText(String pattern) {
    return myMatchingText;
  }

  @Override
  protected SNode doSubstitute(@Nullable EditorContext editorContext, String pattern) {
    SNode newNode = SNodeFactoryOperations.createNewNode(myOutputConcept, null);
    newNode.setProperty(myProperty, "true");
    return myChildSetter.execute(myParentNode, myNodeToReplace, newNode, editorContext);
  }

  @Override
  public SNode getOutputConcept() {
    return SNodeOperations.asNode(myOutputConcept);
  }
}
