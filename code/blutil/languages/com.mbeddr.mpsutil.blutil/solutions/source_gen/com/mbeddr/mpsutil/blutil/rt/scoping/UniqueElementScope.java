package com.mbeddr.mpsutil.blutil.rt.scoping;

/*Generated by MPS */

import jetbrains.mps.scope.DelegatingScope;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.scope.Scope;
import jetbrains.mps.scope.CompositeScope;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.internal.collections.runtime.Sequence;

/**
 * A scope which ensures that no element is contained more than once.
 */
public class UniqueElementScope extends DelegatingScope {

  public static UniqueElementScope create(@NotNull Scope scope) {
    return new UniqueElementScope(scope);
  }

  /**
   * Convenience factory method which allows to create a composite with unique elements.
   * 
   * @param scopes a list of scopes to be composited
   * @return a unique element scope composing all input scopes
   */
  public static UniqueElementScope createComposite(Scope... scopes) {
    Scope compositeScope = CompositeScope.createComposite(scopes);
    return new UniqueElementScope(compositeScope);
  }

  public UniqueElementScope(@NotNull Scope scope) {
    super(scope);
  }

  @Override
  public Iterable<SNode> getAvailableElements(@Nullable String prefix) {
    Iterable<SNode> availableElements = super.getAvailableElements(prefix);
    return Sequence.fromIterable(availableElements).distinct();
  }
}
