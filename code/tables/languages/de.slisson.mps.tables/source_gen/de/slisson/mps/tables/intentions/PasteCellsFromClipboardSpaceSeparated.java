package de.slisson.mps.tables.intentions;

/*Generated by MPS */

import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionFactory;
import java.util.List;
import de.itemis.mps.selection.runtime.intentions.ISelectionIntentionExecutable;
import de.slisson.mps.tables.runtime.selection.TableRangeSelection;
import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionExecutable;
import de.slisson.mps.tables.runtime.plugin.TableData;
import org.jetbrains.mps.openapi.model.SNode;
import de.slisson.mps.tables.runtime.plugin.ClipboardTableUtils;
import de.slisson.mps.tables.runtime.plugin.TableDataSeparator;
import de.slisson.mps.tables.runtime.plugin.CopyPasteSupport;
import java.util.Collections;

public class PasteCellsFromClipboardSpaceSeparated extends AbstractSelectionIntentionFactory {
  public PasteCellsFromClipboardSpaceSeparated() {
  }

  @Override
  public List<ISelectionIntentionExecutable> getInstances(Object selection) {
    if (selection instanceof TableRangeSelection) {
      ISelectionIntentionExecutable intention = new AbstractSelectionIntentionExecutable<TableRangeSelection>() {
        @Override
        public void execute(TableRangeSelection selection) {
          TableData<SNode> data = ClipboardTableUtils.fromClipboard(selection.getTable().getSNode(), TableDataSeparator.SPACE, selection.getEditorComponent().getEditorContext());
          CopyPasteSupport handler = CopyPasteSupport.forNode(selection.getTable().getSNode(), selection.getEditorComponent().getEditorContext());
          handler.paste(selection, data, selection.getEditorComponent().getEditorContext());
        }
        @Override
        public String getDescription(TableRangeSelection selection) {
          return String.format("Paste Cells from Clipboard (%s)", TableDataSeparator.SPACE.getDescription());
        }
        @Override
        public boolean isApplicable(TableRangeSelection selection) {
          return ClipboardTableUtils.isSupportedFlavorAvailableInClipboard() && CopyPasteSupport.existsFor(selection.getTable().getSNode(), selection.getEditorComponent().getEditorContext());
        }
      };
      return Collections.singletonList(intention);
    } else {
      return Collections.<ISelectionIntentionExecutable>emptyList();
    }
  }
}
