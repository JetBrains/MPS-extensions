package de.itemis.model.merge.typesystem;

/*Generated by MPS */

import jetbrains.mps.errors.QuickFix_Runtime;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class fixMissingIdFunction_QuickFix extends QuickFix_Runtime {
  public fixMissingIdFunction_QuickFix() {
    super(new SNodePointer("r:02b6652e-c87d-4bb2-bfc0-4b5c0d5b9442(de.itemis.model.merge.typesystem)", "2904525370366930563"));
  }
  public String getDescription(SNode node) {
    return "Add missing IdFunction";
  }
  public void execute(SNode node) {
    SNode modelMerge = SNodeOperations.getNodeAncestor(node, CONCEPTS.ModelMergingPolicy$MA, false, false);
    SNode mp = ListSequence.fromList(SNodeOperations.getNodeDescendants(modelMerge, CONCEPTS.ConceptMergingPolicy$RB, false, new SAbstractConcept[]{})).findFirst(new _FunctionTypes._return_P1_E0<Boolean, SNode>() {
      public Boolean invoke(SNode mp) {
        return Objects.equals(SLinkOperations.getTarget(mp, LINKS.conceptRef$p8vY), ((SNode) fixMissingIdFunction_QuickFix.this.getField("conc")[0]));
      }
    });
    if ((mp == null)) {
      mp = createConceptMergingPolicy_9tiskx_a0a0c0c(((SNode) fixMissingIdFunction_QuickFix.this.getField("conc")[0]));
      ListSequence.fromList(SLinkOperations.getChildren(modelMerge, LINKS.policies$z8dk)).addElement(mp);
    }
    SLinkOperations.setTarget(mp, LINKS.idFunction$EPRs, CheckinRuleUtil.defaultIdFunction());
  }
  private static SNode createConceptMergingPolicy_9tiskx_a0a0c0c(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ConceptMergingPolicy$RB);
    n0.setReferenceTarget(LINKS.conceptRef$p8vY, p0);
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ModelMergingPolicy$MA = MetaAdapterFactory.getConcept(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1a8b8d3e42dcce87L, "de.itemis.model.merge.structure.ModelMergingPolicy");
    /*package*/ static final SConcept ConceptMergingPolicy$RB = MetaAdapterFactory.getConcept(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1a8b8d3e42de4bf5L, "de.itemis.model.merge.structure.ConceptMergingPolicy");
  }

  private static final class LINKS {
    /*package*/ static final SReferenceLink conceptRef$p8vY = MetaAdapterFactory.getReferenceLink(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1a8b8d3e42de4bf5L, 0x39f51297bd7a5aedL, "conceptRef");
    /*package*/ static final SContainmentLink policies$z8dk = MetaAdapterFactory.getContainmentLink(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1a8b8d3e42dcce87L, 0x1a8b8d3e42de4bf6L, "policies");
    /*package*/ static final SContainmentLink idFunction$EPRs = MetaAdapterFactory.getContainmentLink(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1a8b8d3e42de4bf5L, 0x630e54bf6108c244L, "idFunction");
  }
}
