package de.itemis.mps.editor.diagram.runtime.model;

/*Generated by MPS */

import org.jetbrains.annotations.NotNull;
import org.jetbrains.annotations.Nullable;
import java.util.List;
import java.util.ArrayList;
import javax.swing.Icon;
import java.awt.Graphics2D;
import java.awt.geom.Rectangle2D;

public class ConnectionCreatorAdapter implements IConnectionType_Internal {

  private IConnectionType myCreator;
  private DiagramModel myDiagramModel;

  public ConnectionCreatorAdapter(IConnectionType creator, DiagramModel diagramModel) {
    myCreator = creator;
    myDiagramModel = diagramModel;
  }

  @Override
  public boolean isValidStart(@NotNull Box box, @Nullable String port) {
    return myCreator.isValidStart(toEndpoint(box, port));
  }

  @Override
  public boolean isValidEnd(@NotNull Box box, @Nullable String port) {
    return myCreator.isValidEnd(toEndpoint(box, port));
  }

  @Override
  public boolean canCreate(Box fromBox, String fromPort, Box toBox, String toPort, List<String> allReasons) {
    List<String> reasons = new ArrayList<String>();
    if (!(isValidStart(fromBox, fromPort))) {
      return false;
    }
    if (!(isValidEnd(toBox, toPort))) {
      return false;
    }
    boolean canCreate = myCreator.canCreate(toEndpoint(fromBox, fromPort), toEndpoint(toBox, toPort), reasons);

    if (!(canCreate)) {
      for (String reason : reasons) {
        allReasons.add("[" + getName() + "] " + reason);
      }
    }

    return canCreate;
  }

  public IConnectionEndpoint toEndpoint(Box box, String portName) {
    IConnectionEndpoint_Internal endpoint = check_yfc00g_a0a0m(box, portName);
    if (endpoint == null) {
      endpoint = box;
    }
    return new ConnectionEndpointAdapter(endpoint);
  }

  @Override
  public Edge create(Box fromNode, String fromPort, Box toNode, String toPort) {
    return new PendingEdge(myCreator);
  }

  @Override
  public String getName() {
    return myCreator.getName();
  }

  @Override
  public Icon getIcon() {
    return myCreator.getIcon();
  }

  @Override
  public void drawIcon(Graphics2D g, Rectangle2D bounds) {
    myCreator.drawIcon(g, bounds);
  }

  @Override
  public DiagramModel getDiagramModel() {
    return myDiagramModel;
  }

  @Override
  public boolean showContextButton() {
    return myCreator.showContextButton();
  }
  private static Port check_yfc00g_a0a0m(Box checkedDotOperand, String portName) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getPort(portName);
    }
    return null;
  }
}
