package de.itemis.mps.comparator.code;

/*Generated by MPS */

import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.LinkedList;
import java.util.Iterator;

public class MPSNodeComparisonResult {
  private List<NodeDifference> differences;
  private String expectedName;
  private String actualName;

  protected MPSNodeComparisonResult(String expectedName, String actualName) {
    this.differences = ListSequence.fromList(new LinkedList<NodeDifference>());
    this.expectedName = expectedName;
    this.actualName = actualName;
  }

  public void addDifference(NodeDifference diff) {
    ListSequence.fromList(this.differences).addElement(diff);
  }

  public List<NodeDifference> getDifferences() {
    List<NodeDifference> copy = ListSequence.fromList(new LinkedList<NodeDifference>());
    ListSequence.fromList(copy).addSequence(ListSequence.fromList(differences));
    return copy;
  }

  public boolean areEquals() {
    return ListSequence.fromList(this.differences).count() == 0;
  }

  public String getDescription() {
    return getDescription(expectedName, actualName);
  }

  private String getDescription(String expectedName, String actualName) {
    switch (ListSequence.fromList(this.differences).count()) {
      case 0:
        return "<no diffs>";
      case 1:
        return "[ " + ListSequence.fromList(this.differences).first().getDescription(expectedName, actualName) + " ]";
      default:
        StringBuffer sb = new StringBuffer();
        sb.append("[");
        {
          Iterator<NodeDifference> diff_it = ListSequence.fromList(differences).iterator();
          NodeDifference diff_var;
          while (diff_it.hasNext()) {
            diff_var = diff_it.next();
            sb.append("\n\t");
            sb.append(ComparatorStringUtils.indent(diff_var.getDescription(expectedName, actualName)));
          }
        }
        sb.append("]");
        return sb.toString();
    }
  }

}
