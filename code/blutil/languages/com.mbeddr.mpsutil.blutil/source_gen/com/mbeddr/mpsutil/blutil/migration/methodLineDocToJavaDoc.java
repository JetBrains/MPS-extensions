package com.mbeddr.mpsutil.blutil.migration;

/*Generated by MPS */

import jetbrains.mps.lang.migration.runtime.base.MigrationScriptBase;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.module.SModule;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.lang.migration.runtime.base.MigrationScriptReference;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.smodel.ModelImports;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class methodLineDocToJavaDoc extends MigrationScriptBase {
  private final String description = "methodLineDocToJavaDoc";
  public String getCaption() {
    return description;
  }
  @Override
  public boolean isRerunnable() {
    return true;
  }
  public SNode execute(final SModule m) {
    doExecute(m);
    return null;
  }
  public void doExecute(final SModule m) {
    Iterable<SModel> models = m.getModels();
    for (SModel model : models) {
      ListSequence.fromList(SModelOperations.nodes(model, CONCEPTS.MethodLineDoc$Jr)).where((it) -> !(TestCaseDetection.isInMigrationTestCase(it))).visitAll((it) -> replaceNode(it));
    }
  }
  public MigrationScriptReference getReference() {
    return new MigrationScriptReference(MetaAdapterFactory.getLanguage(0x63e0e5665131447eL, 0x90e312ea330e1a00L, "com.mbeddr.mpsutil.blutil"), 1);
  }


  /*package*/ void replaceNode(SNode node) {
    new ModelImports(SNodeOperations.getModel(node)).addUsedLanguage(MetaAdapterFactory.getLanguage(0xf280165065d5424eL, 0xbb1b463a8781b786L, "jetbrains.mps.baseLanguage.javadoc"));

    SNode nodeWithAnnotation = SNodeOperations.getParent(node);
    SNodeOperations.deleteNode(node);
    String text = SPropertyOperations.getString(node, PROPS.text$n7cC);

    {
      final SNode method = nodeWithAnnotation;
      if (SNodeOperations.isInstanceOf(method, CONCEPTS.BaseMethodDeclaration$kD)) {
        new IAttributeDescriptor.NodeAttribute(CONCEPTS.MethodDocComment$HI).set(method, createMethodDocComment_74btfg_a0a0a6a9(createComment(text)));
        return;
      }
    }
    {
      final SNode declaration = nodeWithAnnotation;
      if (SNodeOperations.isInstanceOf(declaration, CONCEPTS.StaticFieldDeclaration$jR)) {
        new IAttributeDescriptor.NodeAttribute(CONCEPTS.FieldDocComment$wl).set(declaration, createFieldDocComment_74btfg_a0a0a7a9(createComment(text)));
        return;
      }
    }

    {
      final SNode declaration = nodeWithAnnotation;
      if (SNodeOperations.isInstanceOf(declaration, CONCEPTS.FieldDeclaration$ie)) {
        new IAttributeDescriptor.NodeAttribute(CONCEPTS.FieldDocComment$wl).set(declaration, createFieldDocComment_74btfg_a0a0a9a9(createComment(text)));
        return;
      }
    }

    {
      final SNode classifier = nodeWithAnnotation;
      if (SNodeOperations.isInstanceOf(classifier, CONCEPTS.Classifier$Ix)) {
        new IAttributeDescriptor.NodeAttribute(CONCEPTS.ClassifierDocComment$mh).set(classifier, createClassifierDocComment_74btfg_a0a0a11a9(createComment(text)));
        return;
      }
    }

    new IAttributeDescriptor.NodeAttribute(CONCEPTS.BLDoc$UI).set(nodeWithAnnotation, createBLDoc_74btfg_a0a31a9(text));
  }

  /*package*/ SNode createComment(String text) {
    return createCommentLine_74btfg_a0a11(text);
  }
  private static SNode createMethodDocComment_74btfg_a0a0a6a9(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.MethodDocComment$HI);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.body$OAGp).initNode(p0, CONCEPTS.CommentLine$hJ, false);
    }
    return n0.getResult();
  }
  private static SNode createFieldDocComment_74btfg_a0a0a7a9(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.FieldDocComment$wl);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.body$OAGp).initNode(p0, CONCEPTS.CommentLine$hJ, false);
    }
    return n0.getResult();
  }
  private static SNode createFieldDocComment_74btfg_a0a0a9a9(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.FieldDocComment$wl);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.body$OAGp).initNode(p0, CONCEPTS.CommentLine$hJ, false);
    }
    return n0.getResult();
  }
  private static SNode createClassifierDocComment_74btfg_a0a0a11a9(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ClassifierDocComment$mh);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.body$OAGp).initNode(p0, CONCEPTS.CommentLine$hJ, false);
    }
    return n0.getResult();
  }
  private static SNode createBLDoc_74btfg_a0a31a9(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.BLDoc$UI);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.text$Lu49).init(CONCEPTS.Text$bD);
      {
        SNodeBuilder n2 = n1.forChild(LINKS.words$C8QZ).init(CONCEPTS.Word$5r);
        n2.setProperty(PROPS.escapedValue$2Lqz, p0);
      }
    }
    return n0.getResult();
  }
  private static SNode createCommentLine_74btfg_a0a11(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.CommentLine$hJ);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.part$QuzQ).init(CONCEPTS.TextCommentLinePart$Eb);
      n1.setProperty(PROPS.text$aOLd, p0);
    }
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept MethodLineDoc$Jr = MetaAdapterFactory.getConcept(0x63e0e5665131447eL, 0x90e312ea330e1a00L, 0x598910f26a784dfbL, "com.mbeddr.mpsutil.blutil.structure.MethodLineDoc");
    /*package*/ static final SConcept BaseMethodDeclaration$kD = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf8cc56b1fcL, "jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration");
    /*package*/ static final SConcept MethodDocComment$HI = MetaAdapterFactory.getConcept(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x4a3c146b7faeeb34L, "jetbrains.mps.baseLanguage.javadoc.structure.MethodDocComment");
    /*package*/ static final SConcept StaticFieldDeclaration$jR = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf93c84351fL, "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration");
    /*package*/ static final SConcept FieldDocComment$wl = MetaAdapterFactory.getConcept(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x5ed0d79d7dc44bf2L, "jetbrains.mps.baseLanguage.javadoc.structure.FieldDocComment");
    /*package*/ static final SConcept FieldDeclaration$ie = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf8c108ca68L, "jetbrains.mps.baseLanguage.structure.FieldDeclaration");
    /*package*/ static final SConcept Classifier$Ix = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x101d9d3ca30L, "jetbrains.mps.baseLanguage.structure.Classifier");
    /*package*/ static final SConcept ClassifierDocComment$mh = MetaAdapterFactory.getConcept(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x1cb65d9fe66a764cL, "jetbrains.mps.baseLanguage.javadoc.structure.ClassifierDocComment");
    /*package*/ static final SConcept BLDoc$UI = MetaAdapterFactory.getConcept(0x63e0e5665131447eL, 0x90e312ea330e1a00L, 0x3342faffb9e8d4deL, "com.mbeddr.mpsutil.blutil.structure.BLDoc");
    /*package*/ static final SConcept CommentLine$hJ = MetaAdapterFactory.getConcept(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x757ba20a4c87f96cL, "jetbrains.mps.baseLanguage.javadoc.structure.CommentLine");
    /*package*/ static final SConcept Text$bD = MetaAdapterFactory.getConcept(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9e4e61L, "de.slisson.mps.richtext.structure.Text");
    /*package*/ static final SConcept Word$5r = MetaAdapterFactory.getConcept(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9f2e0cL, "de.slisson.mps.richtext.structure.Word");
    /*package*/ static final SConcept TextCommentLinePart$Eb = MetaAdapterFactory.getConcept(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x7c7f5b2f31990287L, "jetbrains.mps.baseLanguage.javadoc.structure.TextCommentLinePart");
  }

  private static final class PROPS {
    /*package*/ static final SProperty text$n7cC = MetaAdapterFactory.getProperty(0x63e0e5665131447eL, 0x90e312ea330e1a00L, 0x598910f26a784dfbL, 0x598910f26a784e11L, "text");
    /*package*/ static final SProperty escapedValue$2Lqz = MetaAdapterFactory.getProperty(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9f2e0cL, 0x237c8da86a9f2e0eL, "escapedValue");
    /*package*/ static final SProperty text$aOLd = MetaAdapterFactory.getProperty(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x7c7f5b2f31990287L, 0x7c7f5b2f31990288L, "text");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink body$OAGp = MetaAdapterFactory.getContainmentLink(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x4a3c146b7fae70d3L, 0x757ba20a4c87f96eL, "body");
    /*package*/ static final SContainmentLink text$Lu49 = MetaAdapterFactory.getContainmentLink(0x63e0e5665131447eL, 0x90e312ea330e1a00L, 0x3342faffb9e8d4deL, 0x3342faffb9e8d4dfL, "text");
    /*package*/ static final SContainmentLink words$C8QZ = MetaAdapterFactory.getContainmentLink(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9e4e61L, 0x237c8da86a9e7aeeL, "words");
    /*package*/ static final SContainmentLink part$QuzQ = MetaAdapterFactory.getContainmentLink(0xf280165065d5424eL, 0xbb1b463a8781b786L, 0x757ba20a4c87f96cL, 0x7c7f5b2f3199028dL, "part");
  }
}
