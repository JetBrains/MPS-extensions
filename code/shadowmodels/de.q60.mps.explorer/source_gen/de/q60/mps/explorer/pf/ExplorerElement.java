package de.q60.mps.explorer.pf;

/*Generated by MPS */

import javax.swing.Icon;
import jetbrains.mps.ide.icons.IdeIcons;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import com.intellij.openapi.util.Computable;
import de.q60.mps.polymorphicfunctions.runtime.IPFContext;

public class ExplorerElement {
  public Object owner;
  public String text;
  public Icon icon = IdeIcons.DEFAULT_ICON;
  public _FunctionTypes._return_P0_E0<? extends SNode> navigationTarget;
  public boolean transparent;
  public List<Child> children = ListSequence.fromList(new ArrayList<Child>());
  public boolean expandByDefault;
  public boolean forceChildrenLazyLoading;
  public Object detailViewRoot;

  public void addChild(String prefix, Object child) {
    ListSequence.fromList(children).addElement(new Child(prefix, child));
  }

  public void addChild(Object child) {
    ListSequence.fromList(children).addElement(new Child(null, child));
  }

  public void addLazyChild(Computable<?> lazyChild) {
    addChild(lazyChild);
  }

  public void addLazyChild(String prefix, Computable<? extends Object> lazyChild) {
    addChild(prefix, lazyChild);
  }

  /**
   * 
   */
  public void addLazyChildFunctionType(String prefix, final _FunctionTypes._return_P0_E0<? extends Object> lazyChild) {
    addChild(prefix, new Computable<Object>() {
      @Override
      public Object compute() {
        return lazyChild.invoke();
      }
    });
  }

  public static class Child {
    public final String prefix;
    public final Object child;
    public final IPFContext context;

    public Child(String prefix, Object child) {
      this.child = child;
      this.prefix = prefix;
      context = IPFContext.CURRENT.getValue();
    }
  }
  @Override
  public String toString() {
    return text;
  }
}
