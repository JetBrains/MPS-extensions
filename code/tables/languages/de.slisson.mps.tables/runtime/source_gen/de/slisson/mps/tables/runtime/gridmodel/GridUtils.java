package de.slisson.mps.tables.runtime.gridmodel;

/*Generated by MPS */

import de.slisson.mps.tables.runtime.simplegrid.IGridLike;
import java.util.Objects;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import de.slisson.mps.tables.runtime.simplegrid.SimpleGrid;
import jetbrains.mps.baseLanguage.tuples.runtime.MultiTuple;

public class GridUtils {
  public static <T> SpanningBounds getSpanningBounds(int elementX, int elementY, IGridLike<T> grid) {
    T element = grid.getElement(elementX, elementY);

    int x1 = elementX;
    int y1 = elementY;
    int x2 = elementX;
    int y2 = elementY;

    while (isValidPosition(x1 - 1, elementY, grid) && Objects.equals(grid.getElement(x1 - 1, elementY), element)) {
      x1--;
    }
    while (isValidPosition(elementX, y1 - 1, grid) && Objects.equals(grid.getElement(elementX, y1 - 1), element)) {
      y1--;
    }
    while (isValidPosition(x2 + 1, elementY, grid) && Objects.equals(grid.getElement(x2 + 1, elementY), element)) {
      x2++;
    }
    while (isValidPosition(elementX, y2 + 1, grid) && Objects.equals(grid.getElement(elementX, y2 + 1), element)) {
      y2++;
    }

    return new SpanningBounds(x1, y1, x2, y2);
  }

  private Tuples._4<Integer, Integer, Integer, Integer> getHeaderBounds(int elementX, int elementY, SimpleGrid<HeaderReference> grid) {
    HeaderReference element = grid.getElement(elementX, elementY);

    int x1 = elementX;
    int y1 = elementY;
    int x2 = elementX;
    int y2 = elementY;

    isValidPosition(x1 - 1, elementY, grid);
    while (grid.isValidPosition(x1 - 1, elementY) && Objects.equals(grid.getElement(x1 - 1, elementY), element)) {
      x1--;
    }
    while (grid.isValidPosition(elementX, y1 - 1) && Objects.equals(grid.getElement(elementX, y1 - 1), element)) {
      y1--;
    }
    while (grid.isValidPosition(x2 + 1, elementY) && Objects.equals(grid.getElement(x2 + 1, elementY), element)) {
      x2++;
    }
    while (grid.isValidPosition(elementX, y2 + 1) && Objects.equals(grid.getElement(elementX, y2 + 1), element)) {
      y2++;
    }


    return MultiTuple.<Integer,Integer,Integer,Integer>from(x1, y1, x2, y2);
  }

  public static boolean isValidPosition(int x, int y, IGridLike grid) {
    return x < grid.getSizeX() && y < grid.getSizeY() && x >= 0 && y >= 0;
  }

}
