package de.slisson.mps.editor.multiline.cells;

/*Generated by MPS */

import de.itemis.mps.editor.celllayout.layout.IndentLayout;
import de.itemis.mps.editor.celllayout.runtime.CellLayoutUtil;
import org.jetbrains.annotations.Nullable;
import de.itemis.mps.editor.celllayout.layout.ILayoutable;
import jetbrains.mps.openapi.editor.cells.EditorCell_Label;
import de.itemis.mps.editor.celllayout.layout.ILayoutableContainer;

public class MultilineLayout extends IndentLayout {

  public MultilineLayout() {
    super(CellLayoutUtil.getIndentSizeSetting());
  }

  @Override
  protected int getIndentAfterWrap(int indentLevel) {
    // No additional indent for wrapped lines.
    return getIndentSize(indentLevel);
  }

  @Override
  protected int getGapBetweenCells(@Nullable ILayoutable left, @Nullable ILayoutable right) {
    int gap = super.getGapBetweenCells(left, right);
    EditorCell_Label leftLabel = as_c1mo7f_a0a1a5(CellLayoutUtil.getEditorCell(left), EditorCell_Label.class);
    if (leftLabel != null && isEmptyString(leftLabel.getText()) && left.getWidth() <= gap) {
      gap -= left.getWidth();
    }
    return gap;
  }

  @Override
  protected int rateWrapPoint(IndentLayout.Word leftWord, IndentLayout.Word rightWord, IndentLayout.Word prevWord) {
    return (getGapBetweenCells(leftWord.getLayoutable(), rightWord.getLayoutable()) == 0 ? 0 : 1);
  }

  @Override
  protected boolean isIndentLayout(ILayoutableContainer container) {
    return container.getLayouter() instanceof IndentLayout;
  }
  private static <T> T as_c1mo7f_a0a1a5(Object o, Class<T> type) {
    return (type.isInstance(o) ? (T) o : null);
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }
}
