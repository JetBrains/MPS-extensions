package de.itemis.mps.editor.bool.runtime;

/*Generated by MPS */

import jetbrains.mps.lang.editor.cellProviders.PropertyCellProvider;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.nodeEditor.cells.ModelAccessor;
import jetbrains.mps.nodeEditor.cells.EditorCell_Property;
import jetbrains.mps.openapi.editor.cells.CellActionType;
import jetbrains.mps.editor.runtime.impl.cellActions.CellAction_DeleteSPropertyOrNode;
import jetbrains.mps.editor.runtime.impl.cellActions.CellAction_DeleteEasily;
import jetbrains.mps.openapi.editor.cells.SubstituteInfo;
import jetbrains.mps.smodel.NodeReadAccessCasterInEditor;
import jetbrains.mps.util.Computable;
import jetbrains.mps.nodeEditor.cellMenu.AbstractNodeSubstituteInfo;
import java.util.List;
import jetbrains.mps.openapi.editor.cells.SubstituteAction;
import java.util.ArrayList;

public class BooleanTextCellProvider extends PropertyCellProvider {
  private String myTrueText;
  private String myFalseText;

  public BooleanTextCellProvider(SNode node, SProperty property, EditorContext context) {
    super(node, property, context);
  }

  public void setTrueText(String text) {
    myTrueText = text;
  }

  public void setFalseText(String text) {
    myFalseText = text;
  }

  @Override
  public EditorCell createEditorCell(EditorContext context) {
    myReadOnly |= getSNode().getModel() == null;

    ModelAccessor propertyAccessor = new BooleanPropertyModelAccessor(getSNode(), getProperty(), myReadOnly, myAllowsEmptyTarget, context, myTrueText, myFalseText);
    EditorCell_Property editorCell = EditorCell_BooleanText.create(context, propertyAccessor, getSNode());
    editorCell.setDefaultText(myNoTargetText);
    if (!(myReadOnly)) {
      editorCell.setAction(CellActionType.DELETE, new CellAction_DeleteSPropertyOrNode(getSNode(), getProperty()));
    } else {
      editorCell.setAction(CellActionType.DELETE, new CellAction_DeleteEasily(getSNode()));
    }
    return editorCell;
  }

  @Override
  public SubstituteInfo createDefaultSubstituteInfo() {
    return NodeReadAccessCasterInEditor.runReadTransparentAction(new Computable<SubstituteInfo>() {
      @Override
      public SubstituteInfo compute() {
        return new AbstractNodeSubstituteInfo(getEditorContext()) {
          protected List<SubstituteAction> createActions() {
            List<SubstituteAction> list = new ArrayList<SubstituteAction>(2);
            list.add(new BooleanTextSubstituteAction(getSNode(), getProperty(), myTrueText, "true"));
            list.add(new BooleanTextSubstituteAction(getSNode(), getProperty(), myFalseText, "false"));
            return list;
          }
        };
      }
    });
  }
}
