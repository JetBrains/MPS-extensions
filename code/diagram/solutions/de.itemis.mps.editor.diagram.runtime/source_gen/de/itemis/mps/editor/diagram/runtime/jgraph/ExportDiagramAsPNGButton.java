package de.itemis.mps.editor.diagram.runtime.jgraph;

/*Generated by MPS */

import com.mxgraph.view.mxCellState;
import java.awt.Graphics2D;
import java.awt.BasicStroke;
import de.itemis.mps.editor.diagram.runtime.model.Bounds;
import java.awt.FontMetrics;
import org.jetbrains.mps.openapi.module.SRepository;
import de.itemis.mps.editor.diagram.runtime.plugin.ImageExportUtil;

public class ExportDiagramAsPNGButton extends ContextButton {

  public ExportDiagramAsPNGButton(double sizeX, double sizeY, mxCellState state) {
    super(sizeX, sizeY, state);
  }

  @Override
  protected void paintSymbol(Graphics2D g) {
    g.setColor(LINE_COLOR);
    g.setStroke(new BasicStroke((float) getLineWidth()));

    Bounds bounds = getBounds();
    String text = "png";
    FontMetrics fm = g.getFontMetrics();
    double x = bounds.getX() + (bounds.getWidth() - fm.stringWidth(text)) / 2;
    double y = bounds.getY() + ((bounds.getHeight() - fm.getHeight()) / 2) + fm.getAscent();

    g.drawString(text, (int) x, (int) y);
  }

  @Override
  protected void execute() {
    RootDiagramECell rootECell = getGraph().getRootDCell().getECell();
    SRepository repository = rootECell.getEditorComponent().getEditorContext().getRepository();
    ImageExportUtil.exportAsPNG(rootECell, repository);
  }

  @Override
  public String getTooltip() {
    return "Export Diagram as a PNG File";
  }
}
