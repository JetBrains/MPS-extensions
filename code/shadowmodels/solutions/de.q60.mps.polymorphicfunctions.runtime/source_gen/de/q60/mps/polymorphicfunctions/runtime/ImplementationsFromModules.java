package de.q60.mps.polymorphicfunctions.runtime;

/*Generated by MPS */

import jetbrains.mps.module.ReloadableModule;
import jetbrains.mps.internal.collections.runtime.Sequence;

public abstract class ImplementationsFromModules implements IImplementationProvider {

  public ImplementationsFromModules() {
  }

  protected abstract Iterable<ReloadableModule> getSModules();
  protected abstract Iterable<String> getModelNames();

  protected PFDescriptor getDescriptor(ReloadableModule module, String modelName) {
    return DescriptorCache.getInstance().getDescriptor(module, modelName);
  }

  public Iterable<PFModule> getPFModules() {
    return Sequence.fromIterable(getSModules()).translate((final ReloadableModule module) -> Sequence.fromIterable(getModelNames()).select((modelName) -> getDescriptor(module, modelName))).where((it) -> it != null).translate((it) -> it.getModules());
  }

  @Override
  public Iterable<IFunctionImplementation> getImplementations(final IPFContext context, final String declarationId, final ParameterList parameters) {
    return Sequence.fromIterable(getPFModules()).translate((it) -> it.getImplementations(context, declarationId, parameters));
  }

  @Override
  public Iterable<IPriorityRule> getPriorityRules() {
    return Sequence.fromIterable(getPFModules()).translate((it) -> it.getPriorityRules());
  }
}
