package de.itemis.model.merge.runtime.runtime;

/*Generated by MPS */

import com.google.common.collect.ImmutableMap;
import java.util.stream.Stream;
import org.apache.commons.lang3.tuple.ImmutablePair;
import java.util.List;
import java.util.stream.Collectors;
import java.util.Set;
import com.google.common.collect.ImmutableBiMap;
import java.util.Collection;
import java.util.Map;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import jetbrains.mps.internal.collections.runtime.CollectionSequence;
import com.google.common.collect.ImmutableSet;
import org.apache.commons.lang3.builder.ToStringBuilder;
import org.apache.commons.lang3.builder.ToStringStyle;

public class MapWrapper<T, S> {
  private ImmutableMap<T, S> propToAction;

  public MapWrapper(ImmutableMap<T, S> p) {
    this.propToAction = p;
  }

  public MapWrapper(Stream<ImmutablePair<T, S>> pairStream) {
    List<ImmutablePair<T, S>> pairs = pairStream.collect(Collectors.<ImmutablePair<T, S>>toList());
    this.propToAction = ImmutableMap.<T,S>builder().putAll(pairs).build();
  }

  public Set<T> keys() {
    return propToAction.keySet();
  }

  public MapWrapper<T, S> merge(MapWrapper<T, S> other) {
    return new MapWrapper(ImmutableBiMap.<T,S>builder().putAll(this.propToAction).putAll(other.propToAction).build());
  }

  public S get(T prop) {
    return propToAction.get(prop);
  }

  public void remove(Collection<T> removeProperty) {
    ImmutableMap.Builder<T, S> builder = ImmutableMap.<T,S>builder();

    for (Map.Entry<T, S> e : SetSequence.fromSet(this.propToAction.entrySet())) {
      T prop = e.getKey();
      if (!(CollectionSequence.fromCollection(removeProperty).contains(prop))) {
        builder.put(e);
      }
    }
    this.propToAction = builder.build();
  }

  public int size() {
    return this.propToAction.size();
  }

  public ImmutableSet<Map.Entry<T, S>> entries() {
    return this.propToAction.entrySet();
  }


  @Override
  public String toString() {
    return new ToStringBuilder(this, ToStringStyle.MULTI_LINE_STYLE).append("Mapping", propToAction).build();
  }
}
