package com.mbeddr.mpsutil.grammarcells.runtime.menu;

/*Generated by MPS */

import jetbrains.mps.nodeEditor.cellMenu.SideTransformCompletionActionItem;
import jetbrains.mps.openapi.editor.menus.transformation.CompletionActionItem;
import jetbrains.mps.openapi.editor.menus.transformation.ConstraintsVerifiableActionItem;
import jetbrains.mps.openapi.editor.menus.transformation.TransformationMenuContext;
import jetbrains.mps.openapi.editor.menus.EditorMenuTraceInfo;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.annotations.NotNull;
import java.util.Objects;
import jetbrains.mps.util.PatternUtil;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.smodel.runtime.IconResource;
import jetbrains.mps.openapi.editor.menus.transformation.CommandPolicy;
import jetbrains.mps.openapi.editor.menus.transformation.TransformationMenuItemVisitor;

public abstract class GrammarCellsSideTransformTransformationMenuItem implements SideTransformCompletionActionItem, CompletionActionItem, ConstraintsVerifiableActionItem {

  private final TransformationMenuContext myContext;
  private EditorMenuTraceInfo trace;

  public GrammarCellsSideTransformTransformationMenuItem(TransformationMenuContext context) {
    myContext = context;
    trace = context.getEditorMenuTrace().getTraceInfo();
  }

  public TransformationMenuContext getContext() {
    return myContext;
  }

  @Nullable
  @Override
  public EditorMenuTraceInfo getTraceInfo() {
    return trace;
  }

  @Override
  public boolean canExecuteStrictly(@NotNull String pattern) {
    if (DisabledOutputConcepts.getInstance(myContext).isDisabled(getOutputConcept())) {
      return false;
    }
    return Objects.equals(pattern, getMatchingText(pattern));
  }
  @Override
  public boolean canExecute(@NotNull String pattern) {
    if (DisabledOutputConcepts.getInstance(myContext).isDisabled(getOutputConcept())) {
      return false;
    }
    return PatternUtil.matchesPattern(pattern, getMatchingText(pattern));
  }
  @Nullable
  @Override
  public String getMatchingText(@NotNull String pattern) {
    return null;
  }
  @Nullable
  @Override
  public SNode getActionType(@NotNull String pattern) {
    return null;
  }
  @Nullable
  @Override
  public IconResource getIcon(String pattern) {
    return null;
  }
  @Nullable
  @Override
  public String getShortDescriptionText(@NotNull String pattern) {
    String description = getOutputConcept().getShortDescription();
    return ((description != null && description.length() > 0) ? description : getOutputConcept().getName());
  }
  @Nullable
  @Override
  public String getLabelText(String pattern) {
    return null;
  }
  @Override
  public void execute(@NotNull String pattern) {
  }
  @NotNull
  @Override
  public CommandPolicy getCommandPolicy() {
    return CommandPolicy.COMMAND_REQUIRED;
  }
  @Override
  public <ResultT> ResultT accept(TransformationMenuItemVisitor<ResultT> visitor) {
    return visitor.visit(this);
  }
}
