package de.itemis.mps.editor.celllayout.layout;

/*Generated by MPS */

import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;

public class LayoutableTraversalExtensions {
  public LayoutableTraversalExtensions() {
  }
  public static ILayoutable firstLeaf(final ILayoutable _this) {
    return LayoutableTraversalExtensions.firstLastLeaf(_this, false);
  }
  public static ILayoutable lastLeaf(final ILayoutable _this) {
    return LayoutableTraversalExtensions.firstLastLeaf(_this, true);
  }
  private static ILayoutable firstLastLeaf(final ILayoutable _this, boolean last) {
    if (_this instanceof ILayoutableContainer) {
      List<ILayoutable> children = ((ILayoutableContainer) _this).getChildren();
      if (ListSequence.fromList(children).isEmpty()) {
        return _this;
      }
      return LayoutableTraversalExtensions.firstLastLeaf(((last ? ListSequence.fromList(children).last() : ListSequence.fromList(children).first())), last);
    } else {
      return _this;
    }
  }
  public static ILayoutable nextLeaf(final ILayoutable _this) {
    return LayoutableTraversalExtensions.prevNextLeaf(_this, true);
  }
  public static ILayoutable prevLeaf(final ILayoutable _this) {
    return LayoutableTraversalExtensions.prevNextLeaf(_this, false);
  }
  private static ILayoutable prevNextLeaf(final ILayoutable _this, boolean next) {
    for (ILayoutableContainer parent = _this.getParent(); parent != null; parent = parent.getParent()) {
      ILayoutable nextSibling = LayoutableTraversalExtensions.sibling(_this.getParent(), next);
      if (nextSibling != null) {
        return (next ? LayoutableTraversalExtensions.firstLeaf(nextSibling) : LayoutableTraversalExtensions.lastLeaf(nextSibling));
      }
    }
    return null;
  }
  public static ILayoutable nextSibling(final ILayoutable _this) {
    return LayoutableTraversalExtensions.sibling(_this, true);
  }
  public static ILayoutable prevSibling(final ILayoutable _this) {
    return LayoutableTraversalExtensions.sibling(_this, true);
  }
  private static ILayoutable sibling(final ILayoutable _this, boolean next) {
    if (_this.getParent() == null) {
      return null;
    }
    List<ILayoutable> children = _this.getParent().getChildren();
    int index = ListSequence.fromList(children).indexOf(_this);
    index += (next ? 1 : -1);
    if (0 <= index && index < ListSequence.fromList(children).count()) {
      return ListSequence.fromList(children).getElement(index);
    } else {
      return null;
    }
  }
}
