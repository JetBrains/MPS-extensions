package de.q60.mps.shadowmodels.target.text.behavior;

/*Generated by MPS */

import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import jetbrains.mps.internal.collections.runtime.Sequence;

public class TextBuffer {

  private StringBuilder buffer = new StringBuilder();
  private int indentLevel = 0;

  public void addText(String text) {
    buffer.append(text);
  }

  public void indentBuffer() {
    for (int i = 0; i < indentLevel; i++) {
      buffer.append("\t");
    }
  }

  public void withIndent(_FunctionTypes._void_P0_E0 r) {
    try {
      indentLevel++;
      r.invoke();
    } finally {
      indentLevel--;
    }
  }

  public void join(Iterable<_FunctionTypes._void_P1_E0<? super TextBuffer>> elements, String separator) {
    boolean first = true;
    for (_FunctionTypes._void_P1_E0<? super TextBuffer> e : Sequence.fromIterable(elements)) {
      if (first) {
        first = false;
      } else {
        addText(separator);
      }
      e.invoke(this);
    }
  }

  public String getText() {
    return buffer.toString();
  }
}
