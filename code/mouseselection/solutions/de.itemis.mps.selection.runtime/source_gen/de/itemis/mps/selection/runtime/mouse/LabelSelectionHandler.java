package de.itemis.mps.selection.runtime.mouse;

/*Generated by MPS */

import jetbrains.mps.openapi.editor.selection.Selection;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorComponent;
import jetbrains.mps.nodeEditor.cells.EditorCell_Label;
import de.itemis.mps.selection.runtime.SelectionUtil;
import jetbrains.mps.nodeEditor.selection.EditorCellLabelSelection;

public class LabelSelectionHandler extends AbstractDragSelectionHandler {
  public Selection createSelection(EditorCell fromCell, EditorCell toCell, int fromX, int fromY, int toX, int toY, EditorComponent editorComponent) {
    if (fromCell == toCell && fromCell instanceof EditorCell_Label) {
      EditorCell_Label label = (EditorCell_Label) fromCell;
      if (label.isSelectable()) {
        int caretFrom = SelectionUtil.xCoordToCaretPos(label, fromX);
        int caretTo = SelectionUtil.xCoordToCaretPos(label, toX);

        if (label.isCaretPositionAllowed(caretTo)) {
          label.setCaretPosition(caretTo);
        }
        label.setSelectionStart(Math.min(caretFrom, caretTo));
        label.setSelectionEnd(Math.max(caretFrom, caretTo));
        return new EditorCellLabelSelection(label);
      }
    }

    return null;
  }

  @Override
  public int getPriority() {
    return 100;
  }
}
