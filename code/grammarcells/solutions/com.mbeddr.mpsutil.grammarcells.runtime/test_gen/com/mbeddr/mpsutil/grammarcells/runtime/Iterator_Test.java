package com.mbeddr.mpsutil.grammarcells.runtime;

/*Generated by MPS */

import org.junit.jupiter.api.Test;
import java.util.Iterator;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import org.junit.Assert;
import org.junit.jupiter.api.BeforeEach;
import jetbrains.mps.internal.collections.runtime.IterableUtils;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.Arrays;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import java.util.List;

public class Iterator_Test {
  private InputCursor input;
  private int counter;
  @Test
  public void test_R_x1x() throws Exception {
    Iterator<InputCursor[]> iterator = input.iterateRanges(ListSequence.fromListAndArray(new ArrayList<ISymbol>(), new DummySymbol(), new DummySymbol(1), new DummySymbol()), false);

    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2"}, new String[]{"3", "4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2", "3"}, new String[]{"4"}, new String[]{});
    Assert.assertFalse(iterator.hasNext());
  }
  @Test
  public void test_L_x1x() throws Exception {
    Iterator<InputCursor[]> iterator = input.iterateRanges(ListSequence.fromListAndArray(new ArrayList<ISymbol>(), new DummySymbol(), new DummySymbol(1), new DummySymbol()), true);

    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2"}, new String[]{"3", "4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{}, new String[]{"1"}, new String[]{"2", "3", "4"});
    Assert.assertFalse(iterator.hasNext());
  }
  @Test
  public void test_L_xx() throws Exception {
    Iterator<InputCursor[]> iterator = input.iterateRanges(ListSequence.fromListAndArray(new ArrayList<ISymbol>(), new DummySymbol(), new DummySymbol()), true);

    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2", "3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3", "4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2", "3", "4"});
    Assert.assertFalse(iterator.hasNext());
  }
  @Test
  public void test_R_xxx() throws Exception {
    Iterator<InputCursor[]> iterator = input.iterateRanges(ListSequence.fromListAndArray(new ArrayList<ISymbol>(), new DummySymbol(), new DummySymbol(), new DummySymbol()), false);

    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2"}, new String[]{"3", "4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2", "3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2", "3", "4"}, new String[]{});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3", "4"}, new String[]{});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2", "3"}, new String[]{"4"}, new String[]{});
    Assert.assertFalse(iterator.hasNext());
  }
  @Test
  public void test_L_xxx() throws Exception {
    Iterator<InputCursor[]> iterator = input.iterateRanges(ListSequence.fromListAndArray(new ArrayList<ISymbol>(), new DummySymbol(), new DummySymbol(), new DummySymbol()), true);

    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1", "2"}, new String[]{"3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2", "3"}, new String[]{"4"});
    Assert.assertTrue(iterator.hasNext());
    compare(iterator.next(), new String[]{"1"}, new String[]{"2"}, new String[]{"3", "4"});
    Assert.assertFalse(iterator.hasNext());
  }
  @BeforeEach
  public void setUp() {
    input = new InputCursor(ListSequence.fromListAndArray(new ArrayList<IToken>(), new ConstantToken("1"), new ConstantToken("2"), new ConstantToken("3"), new ConstantToken("4")));
    counter = 1;
  }

  public void compare(InputCursor[] actualRanges, String[]... expectedRanges) {
    System.out.println("ranges " + counter);
    System.out.println("expected: " + IterableUtils.join(Sequence.fromIterable(Sequence.fromArray(expectedRanges)).select((it) -> Arrays.toString(it)), " # "));
    System.out.println("actual: " + IterableUtils.join(Sequence.fromIterable(Sequence.fromArray(actualRanges)).select((it) -> {
      return ListSequence.fromList(it.getAll()).select(new _FunctionTypes._return_P1_E0<String, IToken>() {
        public String invoke(IToken it) {
          return it.getTextValue();
        }
      }) + "";
    }), " # "));
    counter++;
    Assert.assertEquals(expectedRanges.length, actualRanges.length);
    {
      Iterator<InputCursor> actualRange_it = Sequence.fromArray(actualRanges).iterator();
      Iterator<String[]> expectedRange_it = Sequence.fromArray(expectedRanges).iterator();
      InputCursor actualRange_var;
      String[] expectedRange_var;
      while (actualRange_it.hasNext() && expectedRange_it.hasNext()) {
        actualRange_var = actualRange_it.next();
        expectedRange_var = expectedRange_it.next();
        List<IToken> actualValues = actualRange_var.getAll();
        Assert.assertEquals(expectedRange_var.length, ListSequence.fromList(actualValues).count());
        {
          Iterator<IToken> actual_it = ListSequence.fromList(actualValues).iterator();
          Iterator<String> expected_it = Sequence.fromArray(expectedRange_var).iterator();
          IToken actual_var;
          String expected_var;
          while (actual_it.hasNext() && expected_it.hasNext()) {
            actual_var = actual_it.next();
            expected_var = expected_it.next();
            Assert.assertEquals(expected_var, actual_var.getTextValue());
          }
        }
      }
    }
  }
}
