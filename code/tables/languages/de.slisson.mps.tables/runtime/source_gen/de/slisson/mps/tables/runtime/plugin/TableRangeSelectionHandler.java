package de.slisson.mps.tables.runtime.plugin;

/*Generated by MPS */

import de.itemis.mps.selection.runtime.mouse.AbstractDragSelectionHandler;
import jetbrains.mps.openapi.editor.selection.Selection;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorComponent;
import de.slisson.mps.tables.runtime.cells.EditorCell_GridCell;
import jetbrains.mps.nodeEditor.cells.CellFinderUtil;
import jetbrains.mps.openapi.editor.cells.EditorCell_Collection;
import de.slisson.mps.tables.runtime.selection.TableRangeSelection;

public class TableRangeSelectionHandler extends AbstractDragSelectionHandler {
  @Override
  public Selection createSelection(EditorCell fromCell, EditorCell toCell, int fromX, int fromY, int toX, int toY, EditorComponent editorComponent) {
    EditorCell_GridCell fromGridCell = (EditorCell_GridCell) CellFinderUtil.findParent(fromCell, new InstanceOfCondition<EditorCell_Collection>(EditorCell_GridCell.class));
    if (fromGridCell == null) {
      return null;
    }
    EditorCell_GridCell toGridCell = (EditorCell_GridCell) CellFinderUtil.findParent(toCell, new InstanceOfCondition<EditorCell_Collection>(EditorCell_GridCell.class));
    if (toGridCell == null) {
      return null;
    }
    if (fromGridCell.getTable() != toGridCell.getTable()) {
      return null;
    }
    // selection inside a cell
    if (fromGridCell == toGridCell && fromGridCell != fromCell && toGridCell != toCell) {
      return null;
    }

    return new TableRangeSelection(fromCell.getEditorComponent(), fromGridCell.getTable(), fromGridCell.getGridPosition(), toGridCell.getGridPosition());
  }
}
