package de.q60.mps.logging.runtime;

/*Generated by MPS */

import java.util.List;
import java.util.Collections;
import jetbrains.mps.internal.collections.runtime.LinkedListSequence;
import java.util.LinkedList;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;

public class ShadowLogging {
  private static List<LogEntry> entries = Collections.synchronizedList(LinkedListSequence.fromLinkedList(new LinkedList<LogEntry>()));

  public static void logError(String messagePrefix, Exception ex, Object... details) {
    logError(new LogEntry(messagePrefix + ex.getMessage(), ex.getStackTrace(), details));
  }

  public static void logError(Exception ex, Object... details) {
    logError(new LogEntry(ex.getMessage(), ex.getStackTrace(), details));
  }

  public static void logError(String message, Object... details) {
    logError(new LogEntry(message, details));
  }

  public static void logError(LogEntry entry) {
    synchronized (entries) {
      ListSequence.fromList(entries).insertElement(0, entry);
      if (ListSequence.fromList(entries).count() > 1000) {
        ListSequence.fromList(entries).removeLastElement();
      }
    }
  }

  public static Iterable<LogEntry> getEntries() {
    List<LogEntry> copy;
    synchronized (entries) {
      copy = ListSequence.fromListWithValues(new ArrayList<LogEntry>(), entries);
    }
    return copy;
  }

  public static void clear() {
    ListSequence.fromList(entries).clear();
  }
}
