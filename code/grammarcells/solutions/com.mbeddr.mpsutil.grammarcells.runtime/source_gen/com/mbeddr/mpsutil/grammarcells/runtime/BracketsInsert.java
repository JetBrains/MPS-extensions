package com.mbeddr.mpsutil.grammarcells.runtime;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.HashSet;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SProperty;

public class BracketsInsert {


  public void applyBrackets(SNode node) {
  }


  public void splitExpression() {
  }



  public boolean containsBracket(SNode node, final boolean left) {
    return ListSequence.fromList(SNodeOperations.getNodeDescendants(node, SNodeOperations.asSConcept(SNodeOperations.getConcept(node)), false, new SAbstractConcept[]{})).any((it) -> {
      return ListSequence.fromList(new IAttributeDescriptor.NodeAttribute(CONCEPTS.ArbitraryTextAnnotation$hv).list(it)).any(new _FunctionTypes._return_P1_E0<Boolean, SNode>() {
        public Boolean invoke(SNode it) {
          return SPropertyOperations.getBoolean(it, PROPS.left$Cu1K) == left;
        }
      });
    });
  }

  public SAbstractConcept commonSuperconcept(SAbstractConcept c1, SAbstractConcept c2) {
    Set<SAbstractConcept> all1 = SetSequence.fromSetWithValues(new HashSet<SAbstractConcept>(), SConceptOperations.getAllSuperConcepts(c1, false));
    SetSequence.fromSet(all1).addElement(c1);

    for (SAbstractConcept c : ListSequence.fromList(SConceptOperations.getAllSuperConcepts(c2, false))) {
      if (SetSequence.fromSet(all1).contains(c)) {
        return c;
      }
    }

    return null;
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ArbitraryTextAnnotation$hv = MetaAdapterFactory.getConcept(0xb4f35ed845af4efaL, 0xabe400ac26956e69L, 0x468dcccb641e8fb9L, "com.mbeddr.mpsutil.grammarcells.runtimelang.structure.ArbitraryTextAnnotation");
  }

  private static final class PROPS {
    /*package*/ static final SProperty left$Cu1K = MetaAdapterFactory.getProperty(0xb4f35ed845af4efaL, 0xabe400ac26956e69L, 0x468dcccb641e8fb9L, 0x468dcccb641e9989L, "left");
  }
}
