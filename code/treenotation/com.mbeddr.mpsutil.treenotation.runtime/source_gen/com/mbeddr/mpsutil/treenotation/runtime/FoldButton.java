package com.mbeddr.mpsutil.treenotation.runtime;

/*Generated by MPS */

import org.jetbrains.annotations.NotNull;
import jetbrains.mps.openapi.editor.EditorContext;
import org.jetbrains.mps.openapi.model.SNode;
import java.awt.Graphics2D;
import com.intellij.ui.JBColor;
import java.awt.BasicStroke;
import java.awt.geom.Line2D;

public class FoldButton extends Button {
  private TreeCell myCellToFold;

  public FoldButton(@NotNull EditorContext editorContext, SNode node, TreeCell cellToFold) {
    super(editorContext, node);
    myCellToFold = cellToFold;
  }

  @Override
  public void onClick() {
    myCellToFold.setTreeCollapsed(!(myCellToFold.isTreeCollapsed()));
  }

  @Override
  protected void paintSymbol(Graphics2D g) {
    double width = getWidth();
    double padding = width * 0.2;

    g.setColor(JBColor.BLUE);
    g.setStroke(new BasicStroke(2.0f));
    if (myCellToFold.isTreeCollapsed()) {
      // vertical
      g.draw(new Line2D.Double(getX() + getWidth() / 2, getY() + padding, getX() + getWidth() / 2, getY() + getHeight() - padding));
    }
    // horizontal
    g.draw(new Line2D.Double(getX() + padding, getY() + getHeight() / 2, getX() + getWidth() - padding, getY() + getHeight() / 2));
  }

  @Override
  public float getOpacity() {
    float opacity = super.getOpacity();
    if (myCellToFold.isTreeCollapsed()) {
      opacity = Math.max(opacity, 0.8f);
    }
    return opacity;
  }

  @Override
  protected boolean drawWhenReadonly() {
    return true;
  }
}
