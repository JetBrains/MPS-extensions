package de.q60.mps.shadowmodels.transformation.intentions;

/*Generated by MPS */

import jetbrains.mps.intentions.AbstractIntentionDescriptor;
import jetbrains.mps.openapi.intentions.IntentionFactory;
import java.util.Collection;
import jetbrains.mps.openapi.intentions.IntentionExecutable;
import jetbrains.mps.openapi.intentions.Kind;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import java.util.Collections;
import jetbrains.mps.intentions.AbstractIntentionExecutable;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Objects;
import jetbrains.mps.lang.structure.behavior.AbstractConceptDeclaration__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.openapi.intentions.IntentionDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SConcept;

public final class mapProperties_Intention extends AbstractIntentionDescriptor implements IntentionFactory {
  private Collection<IntentionExecutable> myCachedExecutable;

  public mapProperties_Intention() {
    super(Kind.NORMAL, true, new SNodePointer("r:558acfc6-1a50-4cc1-9a5a-49bfe9543be0(de.q60.mps.shadowmodels.transformation.intentions)", "5809356356123891854"));
  }

  @Override
  public String getPresentation() {
    return "mapProperties";
  }

  @Override
  public boolean isSurroundWith() {
    return false;
  }

  public Collection<IntentionExecutable> instances(final SNode node, final EditorContext context) {
    if (myCachedExecutable == null) {
      myCachedExecutable = Collections.<IntentionExecutable>singletonList(new IntentionImplementation());
    }
    return myCachedExecutable;
  }
  /*package*/ final class IntentionImplementation extends AbstractIntentionExecutable {
    public IntentionImplementation() {
    }

    @Override
    public String getDescription(final SNode node, final EditorContext editorContext) {
      return "Map Properties Of " + SPropertyOperations.getString(SLinkOperations.getTarget(node, LINKS.concept$huZZ), PROPS.conceptAlias$OL_L);
    }

    @Override
    public void execute(final SNode node, final EditorContext editorContext) {
      SNode parameterType = Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.collect(SLinkOperations.getChildren(SNodeOperations.getNodeAncestor(node, CONCEPTS.Transformation$Gz, false, false), LINKS.input$hSH9), LINKS.type$Dgp0), CONCEPTS.TConceptType$x0)).findFirst((it) -> Objects.equals(SLinkOperations.getTarget(it, LINKS.concept$Czlx), SLinkOperations.getTarget(node, LINKS.concept$huZZ)));

      Sequence.fromIterable(SLinkOperations.collectMany(AbstractConceptDeclaration__BehaviorDescriptor.getAllSuperConcepts_id2A8AB0rAWpG.invoke(SLinkOperations.getTarget(parameterType, LINKS.concept$Czlx), ((boolean) true)), LINKS.propertyDeclaration$YUgg)).visitAll((it) -> ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.content$hvH2)).addElement(createPropertyBuilder_uhnc2f_a0a0a0a0c0a(it, it)));
    }

    @Override
    public boolean isApplicable(final SNode node, final EditorContext editorContext) {
      if (!(isApplicableToNode(node, editorContext))) {
        return false;
      }
      return true;
    }

    private boolean isApplicableToNode(final SNode node, final EditorContext editorContext) {
      return Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.collect(SLinkOperations.getChildren(SNodeOperations.getNodeAncestor(node, CONCEPTS.Transformation$Gz, false, false), LINKS.input$hSH9), LINKS.type$Dgp0), CONCEPTS.TConceptType$x0)).any((it) -> Objects.equals(SLinkOperations.getTarget(it, LINKS.concept$Czlx), SLinkOperations.getTarget(node, LINKS.concept$huZZ)));
    }


    @Override
    public IntentionDescriptor getDescriptor() {
      return mapProperties_Intention.this;
    }

  }
  private static SNode createPropertyBuilder_uhnc2f_a0a0a0a0c0a(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.PropertyBuilder$C1);
    n0.setReferenceTarget(LINKS.property$NCWw, p0);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.value$NINT).init(CONCEPTS.DotExpression$yW);
      n1.forChild(LINKS.operand$w6IR).init(CONCEPTS.ContextNodeExpression$zA);
      {
        SNodeBuilder n2 = n1.forChild(LINKS.operation$gs9E).init(CONCEPTS.SPropertyAccess$d9);
        n2.setReferenceTarget(LINKS.property$UiOu, p1);
      }
    }
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SReferenceLink concept$huZZ = MetaAdapterFactory.getReferenceLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c5ee6cL, 0x65cd987c65c684f2L, "concept");
    /*package*/ static final SContainmentLink input$hSH9 = MetaAdapterFactory.getContainmentLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c46e26L, 0x65cd987c65c4b8b3L, "input");
    /*package*/ static final SContainmentLink type$Dgp0 = MetaAdapterFactory.getContainmentLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c4b88cL, 0x65cd987c65c4b8dbL, "type");
    /*package*/ static final SReferenceLink concept$Czlx = MetaAdapterFactory.getReferenceLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c4b895L, 0x65cd987c65c4b898L, "concept");
    /*package*/ static final SContainmentLink propertyDeclaration$YUgg = MetaAdapterFactory.getContainmentLink(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0x1103553c5ffL, 0xf979c3ba6cL, "propertyDeclaration");
    /*package*/ static final SContainmentLink content$hvH2 = MetaAdapterFactory.getContainmentLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c5ee6cL, 0x65cd987c65c684f5L, "content");
    /*package*/ static final SReferenceLink property$NCWw = MetaAdapterFactory.getReferenceLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c5ee6dL, 0x65cd987c65c5ee6fL, "property");
    /*package*/ static final SContainmentLink value$NINT = MetaAdapterFactory.getContainmentLink(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c5ee6dL, 0x65cd987c65c5ee73L, "value");
    /*package*/ static final SContainmentLink operand$w6IR = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x116b46a08c4L, 0x116b46a4416L, "operand");
    /*package*/ static final SContainmentLink operation$gs9E = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x116b46a08c4L, 0x116b46b36c4L, "operation");
    /*package*/ static final SReferenceLink property$UiOu = MetaAdapterFactory.getReferenceLink(0x7866978ea0f04cc7L, 0x81bc4d213d9375e1L, 0x108f96cca6fL, 0x108f9727bcdL, "property");
  }

  private static final class PROPS {
    /*package*/ static final SProperty conceptAlias$OL_L = MetaAdapterFactory.getProperty(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0x1103553c5ffL, 0x46ab0ad5826c74caL, "conceptAlias");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Transformation$Gz = MetaAdapterFactory.getConcept(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c46e26L, "de.q60.mps.shadowmodels.transformation.structure.Transformation");
    /*package*/ static final SConcept TConceptType$x0 = MetaAdapterFactory.getConcept(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c4b895L, "de.q60.mps.shadowmodels.transformation.structure.TConceptType");
    /*package*/ static final SConcept PropertyBuilder$C1 = MetaAdapterFactory.getConcept(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x65cd987c65c5ee6dL, "de.q60.mps.shadowmodels.transformation.structure.PropertyBuilder");
    /*package*/ static final SConcept DotExpression$yW = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x116b46a08c4L, "jetbrains.mps.baseLanguage.structure.DotExpression");
    /*package*/ static final SConcept ContextNodeExpression$zA = MetaAdapterFactory.getConcept(0x94b64715a2634c36L, 0xa1388da14705ffa7L, 0x7f446593fe55e475L, "de.q60.mps.shadowmodels.transformation.structure.ContextNodeExpression");
    /*package*/ static final SConcept SPropertyAccess$d9 = MetaAdapterFactory.getConcept(0x7866978ea0f04cc7L, 0x81bc4d213d9375e1L, 0x108f96cca6fL, "jetbrains.mps.lang.smodel.structure.SPropertyAccess");
  }
}
