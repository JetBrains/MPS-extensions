package com.mbeddr.mpsutil.intentions.runtime;

/*Generated by MPS */

import com.intellij.openapi.actionSystem.DefaultActionGroup;
import jetbrains.mps.openapi.intentions.IntentionExecutable;
import jetbrains.mps.openapi.editor.EditorContext;
import org.jetbrains.mps.openapi.model.SNode;
import com.intellij.openapi.actionSystem.AnActionEvent;
import org.jetbrains.mps.openapi.module.ModelAccess;
import jetbrains.mps.editor.runtime.commands.EditorCommand;

/**
 * An action group that can be performed directly (to execute the intention) but may also contain additional child
 * actions (e.g. to navigate to the intention source).
 */
/*package*/ class IntentionActionGroup extends DefaultActionGroup {
  protected IntentionExecutable myIntention;
  private final EditorContext myEditorContext;
  protected SNode myNode;

  public IntentionActionGroup(IntentionExecutable intention, EditorContext editorContext, SNode node) {
    myIntention = intention;
    myEditorContext = editorContext;
    myNode = node;
  }

  @Override
  public void actionPerformed(AnActionEvent e) {
    ModelAccess modelAccess = myEditorContext.getRepository().getModelAccess();
    modelAccess.executeCommandInEDT(new EditorCommand(myEditorContext) {
      @Override
      public void doExecute() {
        myIntention.execute(myNode, myEditorContext);
      }
    });
  }


}
