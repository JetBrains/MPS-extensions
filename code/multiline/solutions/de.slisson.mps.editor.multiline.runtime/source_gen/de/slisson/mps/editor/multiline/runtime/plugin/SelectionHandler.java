package de.slisson.mps.editor.multiline.runtime.plugin;

/*Generated by MPS */

import de.itemis.mps.selection.runtime.mouse.AbstractDragSelectionHandler;
import jetbrains.mps.openapi.editor.selection.Selection;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorComponent;
import de.slisson.mps.editor.multiline.cells.EditorCell_Word;
import de.slisson.mps.editor.multiline.cells.EditorCell_Multiline;
import de.itemis.mps.selection.runtime.SelectionUtil;
import de.slisson.mps.editor.multiline.cells.MultilineSelection;

public class SelectionHandler extends AbstractDragSelectionHandler {
  public Selection createSelection(@NotNull EditorCell fromCell, @NotNull EditorCell toCell, int fromX, int fromY, int toX, int toY, EditorComponent editorComponent) {

    if (!(fromCell instanceof EditorCell_Word)) {
      return null;
    }
    if (!(toCell instanceof EditorCell_Word)) {
      return null;
    }

    EditorCell_Word fromWord = ((EditorCell_Word) fromCell);
    EditorCell_Word toWord = ((EditorCell_Word) toCell);
    if (fromWord.getParent() != toWord.getParent()) {
      return null;
    }

    EditorCell_Multiline multiline = fromWord.getParent();
    int fromPos = multiline.getCellStartPosition(fromWord) + SelectionUtil.xCoordToCaretPos(fromWord, fromX);
    int toPos = multiline.getCellStartPosition(toWord) + SelectionUtil.xCoordToCaretPos(toWord, toX);

    MultilineSelection selection = new MultilineSelection(editorComponent, multiline, fromPos, toPos);
    return selection;
  }


  @Override
  public int getPriority() {
    return -180;
  }
}
