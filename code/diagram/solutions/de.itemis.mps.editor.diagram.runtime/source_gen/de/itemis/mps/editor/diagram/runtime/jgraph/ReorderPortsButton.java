package de.itemis.mps.editor.diagram.runtime.jgraph;

/*Generated by MPS */

import com.mxgraph.view.mxCellState;
import java.awt.Graphics2D;
import java.awt.BasicStroke;
import de.itemis.mps.editor.diagram.runtime.model.Bounds;
import java.awt.geom.GeneralPath;
import java.awt.geom.Line2D;

public class ReorderPortsButton extends ContextButton {
  public ReorderPortsButton(double size, mxCellState state) {
    super(size, state);
  }
  public ReorderPortsButton(double size, mxCellState state, double spacing) {
    super(size, state, spacing);
  }

  @Override
  protected void paintSymbol(Graphics2D g) {
    g.setColor(LINE_COLOR);
    g.setStroke(new BasicStroke(((float) getLineWidth()), BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND));

    Bounds bounds = getBounds();
    Bounds reducedBounds = bounds.clone();
    reducedBounds.expand(reducedBounds.getWidth() * -0.2);

    // ports
    Bounds port1 = reducedBounds.clone();
    port1.setHeight(port1.getHeight() * 0.4);
    port1.setWidth(port1.getHeight());
    port1.setRight(reducedBounds.getMaxX());
    port1.setCenterY(reducedBounds.getY() + reducedBounds.getHeight() / 4);

    Bounds port2 = port1.clone();
    port2.setCenterY(reducedBounds.getY() + reducedBounds.getHeight() / 4 * 3);

    g.fill(ExtensionMethods.toRectangle2D(port1));
    g.fill(ExtensionMethods.toRectangle2D(port2));


    // box
    GeneralPath box = new GeneralPath();
    box.moveTo(bounds.getMaxX(), reducedBounds.getY());
    box.lineTo(reducedBounds.getMaxX(), reducedBounds.getY());
    box.lineTo(reducedBounds.getMaxX(), reducedBounds.getMaxY());
    box.lineTo(bounds.getMaxX(), reducedBounds.getMaxY());

    g.setColor(LINE_COLOR.darker());
    g.draw(box);

    // edges
    g.draw(new Line2D.Double(bounds.getX(), bounds.getCenterY(), port1.getX(), port1.getCenterY()));
    g.draw(new Line2D.Double(bounds.getX(), reducedBounds.getY(), port2.getX(), port2.getCenterY()));
  }

  @Override
  protected void execute() {
    DiagramActionsUtil.reorderPorts(getGraph(), getCell());
  }

  @Override
  public String getTooltip() {
    return "Reorder Ports";
  }

}
