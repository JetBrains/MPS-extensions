package com.mbeddr.mpsutil.grammarcells.runtime;

/*Generated by MPS */

import jetbrains.mps.lang.editor.cellProviders.PropertyCellProvider;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.nodeEditor.cells.PropertyAccessor;
import jetbrains.mps.openapi.editor.cells.CellActionType;
import jetbrains.mps.editor.runtime.impl.cellActions.CellAction_DeleteSPropertyOrNode;
import jetbrains.mps.editor.runtime.impl.cellActions.CellAction_DeleteEasily;

public class SplittablePropertyCellProvider extends PropertyCellProvider {

  private ITokenizer myTokenizer;

  public SplittablePropertyCellProvider(SNode node, SProperty property, EditorContext editorContext, ITokenizer tokenizer) {
    super(node, property, editorContext);
    myTokenizer = tokenizer;
  }

  @Override
  public EditorCell createEditorCell(EditorContext context) {
    myReadOnly |= getSNode().getModel() == null;
    PropertyAccessor propertyAccessor = new PropertyAccessor(getSNode(), getProperty(), myReadOnly, myAllowsEmptyTarget, context);
    SplittablePropertCell editorCell = SplittablePropertCell.create(context, propertyAccessor, getSNode(), myTokenizer);
    editorCell.setDefaultText(myNoTargetText);
    if (!(myReadOnly)) {
      editorCell.setAction(CellActionType.DELETE, new CellAction_DeleteSPropertyOrNode(getSNode(), getProperty()));
      editorCell.setAction(CellActionType.BACKSPACE, new CellAction_DeleteSPropertyOrNode(getSNode(), getProperty()));
    } else {
      editorCell.setAction(CellActionType.DELETE, new CellAction_DeleteEasily(getSNode()));
      editorCell.setAction(CellActionType.BACKSPACE, new CellAction_DeleteEasily(getSNode()));
    }
    return editorCell;
  }
}
