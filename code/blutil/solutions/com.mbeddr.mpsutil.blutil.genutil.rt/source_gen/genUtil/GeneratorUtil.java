package genUtil;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.generator.template.TemplateQueryContext;
import org.jetbrains.mps.openapi.model.SNodeReference;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;

public class GeneratorUtil {
  public static boolean hasBeenExecuted(SNode n, TemplateQueryContext gencontext, SNodeReference temlateID) {
    return ((TemplateQueryContext) gencontext).getSessionObject(n.getNodeId() + "_" + temlateID) != null;
  }

  public static void setHasBeenExecuted(SNode n, TemplateQueryContext gencontext, SNodeReference temlateID) {
    ((TemplateQueryContext) gencontext).putSessionObject(n.getNodeId() + "_" + temlateID, new Object());
  }

  public static boolean executeOnce(SNode n, TemplateQueryContext gencontext, SNodeReference temlateID) {
    boolean hasBeenExecuted = hasBeenExecuted(n, gencontext, temlateID);
    if (!(hasBeenExecuted)) {
      setHasBeenExecuted(n, gencontext, temlateID);
    }
    return !(hasBeenExecuted);
  }
  public static boolean isInTest(SModel mdl) {
    return ListSequence.fromList(SModelOperations.nodes(mdl, null)).any((it) -> SNodeOperations.getConcept(it).getLanguage().getQualifiedName().startsWith("jetbrains.mps.lang.test"));
  }
}
