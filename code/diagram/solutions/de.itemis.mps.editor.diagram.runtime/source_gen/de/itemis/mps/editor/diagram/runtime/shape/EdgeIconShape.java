package de.itemis.mps.editor.diagram.runtime.shape;

/*Generated by MPS */

import java.awt.Graphics2D;
import java.awt.geom.Rectangle2D;
import de.itemis.mps.editor.diagram.runtime.jgraph.DrawUtil;
import java.awt.BasicStroke;
import java.awt.geom.Line2D;

public class EdgeIconShape extends AbstractShape {

  private IShape myStartShape;
  private IShape myEndShape;

  public EdgeIconShape(IShape startShape, IShape endShape) {
    myEndShape = endShape;
    myStartShape = startShape;
  }

  @Override
  public void draw(Graphics2D g__, final Rectangle2D bounds_, final IShapeStyle_Internal style) {
    DrawUtil.executeWithGraphicsCopy(g__, (Graphics2D g_) -> {
      final Rectangle2D bounds = new Rectangle2D.Double(bounds_.getX(), bounds_.getY(), bounds_.getWidth() * 2, bounds_.getHeight() * 2);

      g_.translate(bounds.getX(), bounds.getY());
      g_.scale(0.5, 0.5);
      g_.translate(-bounds.getX(), -bounds.getY());

      double heightThird = bounds.getHeight() / 3;
      final double widthThird = bounds.getWidth() / 3;
      if (myStartShape != null) {
        final Rectangle2D startBounds = new Rectangle2D.Double(bounds.getX(), bounds.getY() + heightThird, widthThird, heightThird);
        DrawUtil.executeWithGraphicsCopy(g_, (Graphics2D g) -> {
          g.translate(startBounds.getCenterX(), startBounds.getCenterY());
          g.rotate(Math.PI);
          g.translate(-startBounds.getCenterX(), -startBounds.getCenterY());
          myStartShape.draw(g, startBounds, style);
        });
      }
      if (myEndShape != null) {
        final Rectangle2D endBounds = new Rectangle2D.Double(bounds.getX() + widthThird * 2, bounds.getY() + heightThird, widthThird, heightThird);
        DrawUtil.executeWithGraphicsCopy(g_, (Graphics2D g) -> myEndShape.draw(g, endBounds, style));
      }
      DrawUtil.executeWithGraphicsCopy(g_, (Graphics2D g) -> {
        double x1 = (myStartShape == null ? bounds.getX() : bounds.getX() + widthThird);
        double y1 = bounds.getCenterY();
        double x2 = (myEndShape == null ? bounds.getMaxX() : bounds.getMaxX() - widthThird);
        double y2 = bounds.getCenterY();
        g.setStroke(new BasicStroke(1.0f));
        g.draw(new Line2D.Double(x1, y1, x2, y2));
      });
    });



  }
}
