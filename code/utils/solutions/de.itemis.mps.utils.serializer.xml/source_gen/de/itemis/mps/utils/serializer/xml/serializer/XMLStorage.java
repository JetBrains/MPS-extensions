package de.itemis.mps.utils.serializer.xml.serializer;

/*Generated by MPS */

import org.jdom2.Element;
import java.io.IOException;
import org.jdom2.output.XMLOutputter;
import org.jdom2.output.Format;
import java.io.FileWriter;
import org.jdom2.JDOMException;
import java.io.File;
import org.jdom2.input.SAXBuilder;
import org.jdom2.Document;

public class XMLStorage {

  private String filename;
  private Element root;

  public XMLStorage(String filename) {
    this.filename = filename;
  }

  public Element createRootElement(String name) {
    root = new Element(name);
    return root;
  }

  public void store() throws IOException {
    XMLOutputter p = new XMLOutputter(Format.getPrettyFormat());
    FileWriter writer = new FileWriter(filename);
    p.output(root, writer);
  }

  public Element loadAndGetRoot() throws IOException, JDOMException {
    File f = new File(filename);
    ClassLoader cl = Thread.currentThread().getContextClassLoader();
    try {
      Thread.currentThread().setContextClassLoader(this.getClass().getClassLoader());
      SAXBuilder sax = new SAXBuilder();
      Document doc = sax.build(f);
      root = doc.getRootElement();
      return root;
    } finally {
      Thread.currentThread().setContextClassLoader(cl);
    }
  }

}
