package de.slisson.mps.tables.runtime.cells;

/*Generated by MPS */

import jetbrains.mps.openapi.editor.style.StyleAttribute;
import jetbrains.mps.editor.runtime.style.StyleAttributes;
import java.awt.Color;
import de.slisson.mps.tables.runtime.gridmodel.Grid;
import java.awt.Rectangle;
import jetbrains.mps.openapi.editor.style.Style;
import de.slisson.mps.tables.runtime.gridmodel.EditorCellGridLeaf;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.editor.runtime.style.StyleImpl;
import de.slisson.mps.tables.runtime.style.TableStyleUtils;
import java.awt.Graphics;
import jetbrains.mps.nodeEditor.cells.ParentSettings;

public class RowColumnStylePainter {
  private static final StyleAttribute<Integer> STYLE_COLUMN_BORDER_BOTTOM_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "column-border-bottom-width");
  private static final StyleAttribute<Color> STYLE_COLUMN_BORDER_BOTTOM_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "column-border-bottom-color");
  private static final StyleAttribute<Color> STYLE_COLUMN_BORDER_TOP_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "column-border-top-color");
  private static final StyleAttribute<Integer> STYLE_COLUMN_BORDER_TOP_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "column-border-top-width");
  private static final StyleAttribute<Integer> STYLE_COLUMN_BORDER_LEFT_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "column-border-left-width");
  private static final StyleAttribute<Color> STYLE_COLUMN_BORDER_LEFT_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "column-border-left-color");
  private static final StyleAttribute<Color> STYLE_COLUMN_BORDER_RIGHT_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "column-border-right-color");
  private static final StyleAttribute<Integer> STYLE_COLUMN_BORDER_RIGHT_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "column-border-right-width");
  private static final StyleAttribute<Color> STYLE_ROW_BORDER_TOP_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "row-border-top-color");
  private static final StyleAttribute<Integer> STYLE_ROW_BORDER_TOP_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "row-border-top-width");
  private static final StyleAttribute<Integer> STYLE_ROW_BORDER_LEFT_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "row-border-left-width");
  private static final StyleAttribute<Integer> STYLE_ROW_BORDER_RIGHT_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "row-border-right-width");
  private static final StyleAttribute<Integer> STYLE_ROW_BORDER_BOTTOM_WIDTH = StyleAttributes.getInstance().<Integer>getAttribute("de.slisson.mps.tables", "row-border-bottom-width");
  private static final StyleAttribute<Color> STYLE_ROW_BORDER_LEFT_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "row-border-left-color");
  private static final StyleAttribute<Color> STYLE_ROW_BORDER_RIGHT_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "row-border-right-color");
  private static final StyleAttribute<Color> STYLE_ROW_BORDER_BOTTOM_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "row-border-bottom-color");
  private static final StyleAttribute<Color> STYLE_COLUMN_SHADE_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "column-shade-color");
  private static final StyleAttribute<Color> STYLE_ROW_SHADE_COLOR = StyleAttributes.getInstance().<Color>getAttribute("de.slisson.mps.tables", "row-shade-color");

  private Grid myGrid;
  private Rectangle[] myBounds;
  private Style[] myStyles;
  private boolean myPaintColumns;

  public RowColumnStylePainter(Grid grid, boolean paintColumns) {
    myGrid = grid;
    myPaintColumns = paintColumns;
    init();
  }

  private void init() {
    myBounds = new Rectangle[(myPaintColumns ? myGrid.getSizeX() : myGrid.getSizeY())];
    myStyles = new Style[myBounds.length];
    for (int rowNum = 0; rowNum < myGrid.getSizeY(); rowNum++) {
      for (int colNum = 0; colNum < myGrid.getSizeX(); colNum++) {
        EditorCellGridLeaf leaf = as_j4h7hx_a0a0a0a2a62(myGrid.getElement(colNum, rowNum), EditorCellGridLeaf.class);
        if (leaf == null) {
          continue;
        }
        processCell(leaf.getEditorCell(), leaf.getStyle(), (myPaintColumns ? colNum : rowNum));
      }
    }
  }

  private void processCell(EditorCell cell, Style style, int index) {
    if (myStyles[index] == null) {
      myStyles[index] = new StyleImpl();
    }
    if (cell == null) {
      return;
    }
    if (check_j4h7hx_a2a82(as_j4h7hx_a0a2a82(cell, EditorCell_GridCell.class))) {
      return;
    }
    if (myBounds[index] == null) {
      myBounds[index] = TableUtils.getCellBounds(cell);
    } else {
      myBounds[index] = myBounds[index].union(TableUtils.getCellBounds(cell));
    }
    myStyles[index] = TableStyleUtils.combine(myStyles[index], style);
  }

  public void paintBackground(Graphics g, ParentSettings parentSettings) {
    for (int i = 0; i < myBounds.length; i++) {
      Rectangle bounds = myBounds[i];
      Style style = myStyles[i];
      if (style == null) {
        style = new StyleImpl();
      }
      if (style.isSpecified((myPaintColumns ? STYLE_COLUMN_SHADE_COLOR : STYLE_ROW_SHADE_COLOR))) {
        g.setColor(style.get((myPaintColumns ? STYLE_COLUMN_SHADE_COLOR : STYLE_ROW_SHADE_COLOR)));
        g.fillRect(bounds.x, bounds.y, bounds.width, bounds.height);
      }
    }
  }

  public void paintForeground(Graphics g, ParentSettings parentSettings) {
    if (1 == 1) {
      return;
    }
    for (int i = 0; i < myBounds.length; i++) {
      Rectangle bounds = myBounds[i];
      Style style = myStyles[i];
      if (style == null) {
        style = new StyleImpl();
      }
      if (myPaintColumns) {
        TableUtils.paintBorders(g, bounds, style.get(STYLE_COLUMN_BORDER_TOP_COLOR), style.get(STYLE_COLUMN_BORDER_TOP_WIDTH), style.get(STYLE_COLUMN_BORDER_LEFT_COLOR), style.get(STYLE_COLUMN_BORDER_LEFT_WIDTH), style.get(STYLE_COLUMN_BORDER_RIGHT_COLOR), style.get(STYLE_COLUMN_BORDER_RIGHT_WIDTH), style.get(STYLE_COLUMN_BORDER_BOTTOM_COLOR), style.get(STYLE_COLUMN_BORDER_BOTTOM_WIDTH));
      } else {
        TableUtils.paintBorders(g, bounds, style.get(STYLE_ROW_BORDER_TOP_COLOR), style.get(STYLE_ROW_BORDER_TOP_WIDTH), style.get(STYLE_ROW_BORDER_LEFT_COLOR), style.get(STYLE_ROW_BORDER_LEFT_WIDTH), style.get(STYLE_ROW_BORDER_RIGHT_COLOR), style.get(STYLE_ROW_BORDER_RIGHT_WIDTH), style.get(STYLE_ROW_BORDER_BOTTOM_COLOR), style.get(STYLE_ROW_BORDER_BOTTOM_WIDTH));
      }
    }
  }

  private static boolean check_j4h7hx_a2a82(EditorCell_GridCell checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.isRowEndCell();
    }
    return false;
  }
  private static <T> T as_j4h7hx_a0a0a0a2a62(Object o, Class<T> type) {
    return (type.isInstance(o) ? (T) o : null);
  }
  private static <T> T as_j4h7hx_a0a2a82(Object o, Class<T> type) {
    return (type.isInstance(o) ? (T) o : null);
  }
}
