package de.itemis.mps.editor.diagram.runtime.jgraph;

/*Generated by MPS */

import com.mxgraph.view.mxCellState;
import com.mxgraph.view.mxGraph;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.Sequence;
import de.itemis.mps.editor.diagram.runtime.model.Bounds;
import jetbrains.mps.internal.collections.runtime.ListSequence;

public abstract class AlignButton extends ContextButton {
  public AlignButton(double size, mxCellState state) {
    super(size, state);
  }
  public AlignButton(double size, mxCellState state, double spacing) {
    super(size, state, spacing);
  }

  @Override
  protected void execute() {
    BaseDCell cell = ((BaseDCell) myCellState.getCell());
    mxGraph graph = myCellState.getView().getGraph();
    List<BaseDCell> otherCells = Sequence.fromIterable(Sequence.fromArray(graph.getSelectionCells())).ofType(BaseDCell.class).subtract(Sequence.fromIterable(Sequence.<BaseDCell>singleton(cell))).toList();

    graph.getModel().beginUpdate();
    try {
      Bounds prevBounds = CellExtensions.getAbsoluteBounds(cell);
      for (BaseDCell otherCell : ListSequence.fromList(otherCells)) {
        doAlign(cell, otherCell);
      }
      CellExtensions.setAbsoluteBounds(cell, prevBounds);
    } finally {
      graph.getModel().endUpdate();
    }
  }

  protected abstract void doAlign(BaseDCell cell, BaseDCell otherCell);
}
