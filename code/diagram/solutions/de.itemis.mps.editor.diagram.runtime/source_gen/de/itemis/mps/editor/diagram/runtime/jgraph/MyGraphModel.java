package de.itemis.mps.editor.diagram.runtime.jgraph;

/*Generated by MPS */

import com.mxgraph.model.mxGraphModel;
import de.itemis.mps.editor.diagram.runtime.model.IDiagramElement;
import de.itemis.mps.editor.diagram.runtime.model.IDiagramElementAccessor;
import java.util.Objects;
import java.util.UUID;

public class MyGraphModel extends mxGraphModel {

  private String myLastGeneratedId = null;

  public MyGraphModel() {
    setMaintainEdgeParent(false);
  }

  @Override
  public String createId(Object cell) {
    if (cell instanceof IDiagramDCell) {
      IDiagramElement diagramElement = ((IDiagramDCell) cell).getDiagramElement();
      IDiagramElementAccessor accessor = check_o6noab_a0b0a0f(diagramElement);
      if (diagramElement != null && accessor != null) {
        String id = diagramElement.getModel().getDiagramAccessor().getId().serialize() + "#" + accessor.getId().serialize();
        if (Objects.equals(myLastGeneratedId, id)) {
          // JGraph tries to resolve duplicate IDs by executing createId until it receive a unique ID.
          // This can result in an infinite loop, because return the same ID for each call.
          id = UUID.randomUUID().toString();
        }
        myLastGeneratedId = id;
        return id;
      }
    }
    myLastGeneratedId = null;
    return UUID.randomUUID().toString();
  }
  private static IDiagramElementAccessor check_o6noab_a0b0a0f(IDiagramElement checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getAccessor();
    }
    return null;
  }
}
