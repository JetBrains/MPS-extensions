package de.q60.mps.shadowmodels.runtime.engine;

/*Generated by MPS */

import org.modelix.model.api.IConcept;

public class InlineContributionContext extends BuilderContextWrapper implements IBuilderContext {

  private TransformationResult.ResultElement targetElement;

  public InlineContributionContext(IBuilderContext sourceContext, TransformationResult.ResultElement targetElement) {
    super(sourceContext);
    this.targetElement = targetElement;
  }

  @Override
  public IBuilderContext createNode(IConcept concept, IBuilderContext topmost) {
    if (topmost.getParameter(BuilderContextParameter.LOCAL_LABEL) != null) {
      throw new UnsupportedOperationException("Label not supported");
    }
    if (topmost.getParameter(BuilderContextParameter.MAPPING_LABEL) != null) {
      throw new UnsupportedOperationException("Mapping label not supported");
    }

    if (!(targetElement.getConcept().isSubConceptOf(concept))) {
      throw new RuntimeException(targetElement.getConcept() + " is not a subconcept of " + concept);
    }
    return new ResultElementContext(this, targetElement);
  }

  @Override
  public void createNode(IContainmentTarget problem, IBuilderContext topmost) {
    throw new UnsupportedOperationException("Not allowed in contributions");
  }

  @Override
  public TransformationResult.ResultElement getResultElement() {
    return targetElement;
  }
}
