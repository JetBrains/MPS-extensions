package com.mbeddr.mpsutil.grammarcells.runtime;

/*Generated by MPS */

import jetbrains.mps.lang.editor.menus.substitute.DefaultSubstituteMenuItem;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.openapi.editor.menus.substitute.SubstituteMenuContext;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.annotations.NotNull;

public class FlagSubstituteMenuItem extends DefaultSubstituteMenuItem {

  private final String myMatchingText;
  private final IFlagModelAccess myModelAccess;

  public FlagSubstituteMenuItem(SNode parentNode, SNode nodeToReplace, SAbstractConcept outputConcept, SProperty property, String matchingText, SubstituteMenuContext context) {
    this(parentNode, nodeToReplace, outputConcept, matchingText, context, new DefaultFlagModelAccess(property));
  }

  public FlagSubstituteMenuItem(SNode parentNode, SNode nodeToReplace, SAbstractConcept outputConcept, String matchingText, SubstituteMenuContext context, IFlagModelAccess modelAccess) {
    super(outputConcept, context);
    // FIXME nodeToReplace is not used, remove?
    myMatchingText = matchingText;
    myModelAccess = modelAccess;
  }

  public String getMatchingText(String pattern) {
    return myMatchingText;
  }

  @Nullable
  @Override
  public String getDescriptionText(@NotNull String pattern) {
    String description = getOutputConcept().getShortDescription();
    return ((description != null && description.length() > 0) ? description : getOutputConcept().getName());
  }

  @Override
  public SNode createNode(@NotNull String pattern) {
    SNode newNode = super.createNode(pattern);
    myModelAccess.write(newNode, true);
    return newNode;
  }
}
