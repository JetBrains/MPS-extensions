package de.itemis.mps.editor.diagram.runtime.shape;

/*Generated by MPS */

import java.awt.geom.Path2D;
import java.awt.geom.Rectangle2D;
import java.awt.geom.AffineTransform;
import java.awt.Paint;
import java.awt.Color;
import java.awt.GradientPaint;

public class ShapeUtil {
  public static Path2D changeBounds(Path2D path, Rectangle2D bounds) {
    Path2D copy = (Path2D) path.clone();
    Rectangle2D pathBounds = path.getBounds2D();
    AffineTransform toRelative = AffineTransform.getScaleInstance(1.0 / pathBounds.getWidth(), 1.0 / pathBounds.getHeight());
    toRelative.translate(-pathBounds.getX(), -pathBounds.getY());
    copy.transform(toRelative);

    AffineTransform toTarget = AffineTransform.getTranslateInstance(bounds.getX(), bounds.getY());
    toTarget.scale(bounds.getWidth(), bounds.getHeight());
    copy.transform(toTarget);
    return copy;
  }

  public static Paint createGradientPaint(Color color, Rectangle2D bounds) {
    return createGradientPaint(color, bounds, 0.15f);
  }

  public static Paint createGradientPaint(Color color, Rectangle2D bounds, float variance) {
    float centerBrightness = getBrightness(color);
    centerBrightness = Math.min(Math.max(centerBrightness, variance), 1.0f - variance);

    Color color1 = setBrightness(color, centerBrightness + variance);
    Color color2 = setBrightness(color, centerBrightness - variance);
    return new GradientPaint((float) bounds.getMinX(), (float) bounds.getMinY(), color1, (float) bounds.getMaxX(), (float) bounds.getMaxY(), color2, false);
  }

  public static Color changeBrightness(Color c, float relativeChange) {
    return setBrightness(c, getBrightness(c) * relativeChange);
  }

  public static float getBrightness(Color c) {
    float[] hsb = new float[3];
    Color.RGBtoHSB(c.getRed(), c.getGreen(), c.getBlue(), hsb);
    float brightness = hsb[2];
    return brightness;
  }

  public static Color setBrightness(Color c, float brightness) {
    float[] hsb = new float[3];
    Color.RGBtoHSB(c.getRed(), c.getGreen(), c.getBlue(), hsb);
    if (brightness < 0.0f) {
      brightness = 0.0f;
    }
    if (brightness > 1.0f) {
      brightness = 1.0f;
    }
    Color c2 = new Color(Color.HSBtoRGB(hsb[0], hsb[1], brightness));
    return c2;
  }

  public static double calcShapeSize(IShape shape, Double size) {
    if (size != null) {
      return size;
    }
    if (shape != null) {
      Double defaultSize = shape.getDefaultSize();
      if (defaultSize != null) {
        return defaultSize;
      }
    }
    return 6.0;
  }
}
