package de.slisson.mps.tables.runtime.gridmodel;

/*Generated by MPS */

import jetbrains.mps.openapi.editor.cells.CellAction;
import jetbrains.mps.openapi.editor.cells.SubstituteInfo;
import jetbrains.mps.openapi.editor.style.Style;
import jetbrains.mps.editor.runtime.style.StyleImpl;
import de.slisson.mps.tables.runtime.simplegrid.IGridLike;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import jetbrains.mps.baseLanguage.tuples.runtime.MultiTuple;

public abstract class GridElement implements IGridElement {

  private int mySpanX = 1;
  private int mySpanY = 1;
  private PriorizedValue<IRowCreateHandler> myLeftRowCreateHandler;
  private PriorizedValue<IRowCreateHandler> myRightRowCreateHandler;
  private PriorizedValue<IRowDeleteHandler> myLeftRowDeleteHandler;
  private PriorizedValue<IRowDeleteHandler> myRightRowDeleteHandler;
  private PriorizedValue<CellAction> myInsertAction;
  private PriorizedValue<CellAction> myInsertBeforeAction;
  private PriorizedValue<CellAction> myPasteAction;
  private PriorizedValue<CellAction> myDeleteAction;
  private PriorizedValue<SubstituteInfo> mySubstituteInfo;
  private Style myStyle = null;
  private int myWidth;
  private int myHeight;

  @Override
  public void visitElements(IGridElementVisitor visitor) {
    visitor.visit(this);
  }

  @Override
  public int getSpanX() {
    return mySpanX;
  }

  public Style getStyle() {
    if (myStyle == null) {
      myStyle = new StyleImpl();
    }
    return myStyle;
  }
  public void setStyle(Style style) {
    myStyle = style;
  }

  public void setOrAddStyle(Style style) {
    if (myStyle == null) {
      setStyle(style);
    } else {
      myStyle.putAll(style);
    }
  }

  @Override
  public int getSpanY() {
    return mySpanY;
  }

  @Override
  public void setSpanX(int span) {
    if (span < 1) {
      throw new IllegalArgumentException("span must be >= 1, span = " + span);
    }
    mySpanX = span;
  }

  public void incrementSpanningX(IGrid yourGrid, int yourX, int yourY) {
    setSpanX(getSpanX() + 1);
  }

  public void incrementSpanningY(IGrid yourGrid, int yourX, int yourY) {
    setSpanY(getSpanY() + 1);
  }

  @Override
  public void setSpanY(int span) {
    if (span < 1) {
      throw new IllegalArgumentException("span must be >= 1, span = " + span);
    }
    mySpanY = span;
  }

  @Override
  public void setSpanToSize() {
    setSpanX(1);
    setSpanY(1);
  }

  public void setSpanToSize(IGridLike grid) {
    setSpanX(grid.getSizeX());
    setSpanY(grid.getSizeY());
  }


  public PriorizedValue<SubstituteInfo> getSubstituteInfo() {
    return mySubstituteInfo;
  }

  public void setSubstituteInfo(SubstituteInfo substituteInfo) {
    setSubstituteInfo(substituteInfo, 0);
  }

  public void setSubstituteInfo(SubstituteInfo substituteInfo, int priority) {
    if (substituteInfo == null) {
      mySubstituteInfo = null;
    } else {
      mySubstituteInfo = new PriorizedValue<SubstituteInfo>(substituteInfo, priority);
    }
  }

  @Override
  public void combineWithParent(IGridElement parent) {
    myLeftRowCreateHandler = PriorizedValue.getHigher(myLeftRowCreateHandler, parent.getLeftRowCreateHandler());
    myRightRowCreateHandler = PriorizedValue.getHigher(myRightRowCreateHandler, parent.getRightRowCreateHandler());
    myLeftRowDeleteHandler = PriorizedValue.getHigher(myLeftRowDeleteHandler, parent.getLeftRowDeleteHandler());
    myRightRowDeleteHandler = PriorizedValue.getHigher(myRightRowDeleteHandler, parent.getRightRowDeleteHandler());
    myInsertAction = PriorizedValue.getHigher(myInsertAction, parent.getInsertAction());
    myInsertBeforeAction = PriorizedValue.getHigher(myInsertBeforeAction, parent.getInsertBeforeAction());
    myPasteAction = PriorizedValue.getHigher(myPasteAction, parent.getPasteAction());
    myDeleteAction = PriorizedValue.getHigher(myDeleteAction, parent.getDeleteAction());

    mySubstituteInfo = PriorizedValue.getHigher(mySubstituteInfo, parent.getSubstituteInfo());

    if (hasStyle() || parent.hasStyle()) {
      Style newStyle = new StyleImpl();
      if (parent.hasStyle()) {
        newStyle.putAll(parent.getStyle());
      }
      if (hasStyle()) {
        newStyle.putAll(myStyle);
      }
      myStyle = newStyle;
    }
  }

  public boolean hasStyle() {
    return myStyle != null;
  }

  @Override
  public void replace(IGridElement replaced) {
    combineWithParent(replaced);
  }

  public void setLeftRowCreateHandler(IRowCreateHandler handler) {
    setLeftRowCreateHandler(handler, 0);
  }

  public void setRightRowCreateHandler(IRowCreateHandler handler) {
    setRightRowCreateHandler(handler, 0);
  }

  @Override
  public PriorizedValue<IRowCreateHandler> getLeftRowCreateHandler() {
    return myLeftRowCreateHandler;
  }

  @Override
  public PriorizedValue<IRowCreateHandler> getRightRowCreateHandler() {
    return myRightRowCreateHandler;
  }

  @Override
  public void setLeftRowCreateHandler(IRowCreateHandler handler, int priority) {
    if (handler == null) {
      myLeftRowCreateHandler = null;
    } else {
      myLeftRowCreateHandler = new PriorizedValue<IRowCreateHandler>(handler, priority);
    }
  }

  @Override
  public void setRightRowCreateHandler(IRowCreateHandler handler, int priority) {
    if (handler == null) {
      myRightRowCreateHandler = null;
    } else {
      myRightRowCreateHandler = new PriorizedValue<IRowCreateHandler>(handler, priority);
    }
  }

  public void setLeftRowDeleteHandler(IRowDeleteHandler handler) {
    setLeftRowDeleteHandler(handler, 0);
  }
  public void setRightRowDeleteHandler(IRowDeleteHandler handler) {
    setRightRowDeleteHandler(handler, 0);
  }

  @Override
  public PriorizedValue<IRowDeleteHandler> getLeftRowDeleteHandler() {
    return myLeftRowDeleteHandler;
  }

  @Override
  public PriorizedValue<IRowDeleteHandler> getRightRowDeleteHandler() {
    return myRightRowDeleteHandler;
  }

  @Override
  public void setLeftRowDeleteHandler(IRowDeleteHandler handler, int priority) {
    if (handler == null) {
      myLeftRowDeleteHandler = null;
    } else {
      myLeftRowDeleteHandler = new PriorizedValue<IRowDeleteHandler>(handler, priority);
    }
  }
  @Override
  public void setRightRowDeleteHandler(IRowDeleteHandler handler, int priority) {
    if (handler == null) {
      myRightRowDeleteHandler = null;
    } else {
      myRightRowDeleteHandler = new PriorizedValue<IRowDeleteHandler>(handler, priority);
    }
  }

  @Override
  public void setInsertAction(CellAction action) {
    setInsertAction(action, 0);
  }

  @Override
  public void setInsertBeforeAction(CellAction handler) {
    setInsertBeforeAction(handler, 0);
  }

  @Override
  public void setPasteAction(CellAction action) {
    setDeleteAction(action, 0);
  }

  @Override
  public PriorizedValue<CellAction> getInsertAction() {
    return myInsertAction;
  }

  @Override
  public PriorizedValue<CellAction> getInsertBeforeAction() {
    return myInsertBeforeAction;
  }

  @Override
  public PriorizedValue<CellAction> getPasteAction() {
    return myPasteAction;
  }

  @Override
  public PriorizedValue<CellAction> getDeleteAction() {
    return myDeleteAction;
  }

  @Override
  public void setInsertAction(CellAction action, int priority) {
    if (action == null) {
      myInsertAction = null;
    } else {
      myInsertAction = new PriorizedValue<CellAction>(action, priority);
    }
  }
  @Override
  public void setInsertBeforeAction(CellAction action, int priority) {
    if (action == null) {
      myInsertBeforeAction = null;
    } else {
      myInsertBeforeAction = new PriorizedValue<CellAction>(action, priority);
    }
  }
  @Override
  public void setPasteAction(CellAction action, int priority) {
    if (action == null) {
      myPasteAction = null;
    } else {
      myPasteAction = new PriorizedValue<CellAction>(action, priority);
    }
  }

  @Override
  public void setDeleteAction(CellAction action, int priority) {
    if (action == null) {
      myDeleteAction = null;
    } else {
      myDeleteAction = new PriorizedValue<CellAction>(action, priority);
    }
  }

  @Override
  public GridElement clone() {
    try {
      GridElement clone = (GridElement) super.clone();
      return clone;
    } catch (CloneNotSupportedException ex) {
      throw new RuntimeException(ex);
    }
  }

  public void transpose() {
    {
      Tuples._2<Integer, Integer> _tmp_gonwij_a0sd = MultiTuple.<Integer,Integer>from(mySpanY, mySpanX);
      mySpanX = _tmp_gonwij_a0sd._0();
      mySpanY = _tmp_gonwij_a0sd._1();
    }
  }

  public int getHeight() {
    return myHeight;
  }

  public int getWidth() {
    return myWidth;
  }

  public void setHeight(int height) {
    myHeight = height;
  }

  public void setWidth(int width) {
    myWidth = width;
  }

  public int getMinHeight() {
    return 0;
  }

  public int getMinWidth() {
    return 0;
  }
}
