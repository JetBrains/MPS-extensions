package com.mbeddr.mpsutil.grammarcells.runtime.insertpopup;

/*Generated by MPS */

import jetbrains.mps.openapi.editor.EditorComponent;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.cells.CellAction;
import java.util.List;
import jetbrains.mps.openapi.editor.cells.CellActionType;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.openapi.editor.EditorContext;

/**
 * User: shatalin
 * Date: 2/12/13
 */
public class ActionHandlerImpl {
  private final EditorComponent myEditorComponent;
  public ActionHandlerImpl(EditorComponent editorComponent) {
    myEditorComponent = editorComponent;
  }
  public boolean executeAction(EditorCell editorCell, final CellAction action) {
    if (editorCell == null || action == null) {
      return false;
    }
    CellActionExecuter cellActionExecuter = CellActionExecuter.getExecutableExecuter(editorCell, action, getEditorContext());
    if (cellActionExecuter != null) {
      cellActionExecuter.execute();
      return true;
    } else {
      return false;
    }
  }
  public List<CellAction> getApplicableCellAction(final EditorCell editorCell, final CellActionType type) {
    List<CellActionExecuter> cellActionExecuter = findCellActionExecuter(editorCell, type);
    return ListSequence.fromList(cellActionExecuter).select((it) -> it.getAction()).toList();
  }
  public List<CellActionExecuter> findCellActionExecuter(EditorCell editorCell, CellActionType type) {
    if (editorCell == null || type == null) {
      return null;
    }
    return new CellActionExecutorFinder(editorCell, type, myEditorComponent).findCellActionExecuter();
  }
  private EditorContext getEditorContext() {
    return myEditorComponent.getEditorContext();
  }
}
