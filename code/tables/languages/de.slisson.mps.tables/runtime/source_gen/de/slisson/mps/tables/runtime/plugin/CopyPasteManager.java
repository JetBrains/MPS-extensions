package de.slisson.mps.tables.runtime.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.smodel.structure.ExtensionPoint;

public class CopyPasteManager {
  public static boolean isSupported(SNode node, EditorContext editorContext) {
    return createIfSupported(node, editorContext) != null;
  }

  public static CopyPasteSupport create(SNode node, EditorContext editorContext) {
    CopyPasteSupport copyPasteSupport = createIfSupported(node, editorContext);
    if (copyPasteSupport == null) {
      throw new IllegalArgumentException(String.format("No %s for %s", CopyPasteSupport.class.getSimpleName(), SNodeOperations.getConcept(node).getName()));
    }

    return copyPasteSupport;
  }

  public static CopyPasteSupport createIfSupported(final SNode node, final EditorContext editorContext) {
    return Sequence.fromIterable(new ExtensionPoint<CopyPasteSupport>("de.slisson.mps.tables.runtime.TableCopyPaste").getObjects()).where((it) -> it.isApplicable(node, editorContext)).sort((it) -> it.priority(), true).last();
  }
}
