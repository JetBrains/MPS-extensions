package com.mbeddr.mpsutil.grammarcells.runtime.menu;

/*Generated by MPS */

import jetbrains.mps.lang.editor.menus.MenuPart;
import jetbrains.mps.openapi.editor.menus.substitute.SubstituteMenuItem;
import jetbrains.mps.openapi.editor.menus.substitute.SubstituteMenuContext;
import org.jetbrains.mps.openapi.module.SModule;
import org.jetbrains.mps.openapi.module.SRepository;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.annotations.NotNull;
import java.util.List;
import com.mbeddr.mpsutil.grammarcells.runtime.IGrammarActionsDescriptor;
import com.mbeddr.mpsutil.grammarcells.runtime.GrammarCellsUtil;
import java.util.Collections;
import jetbrains.mps.internal.collections.runtime.ListSequence;

public abstract class GrammarCellsSubstituteMenuPart implements MenuPart<SubstituteMenuItem, SubstituteMenuContext> {

  @Deprecated
  public abstract SModule getModule(SRepository repository);
  public abstract SAbstractConcept getExpectedOutputConcept();

  @NotNull
  @Override
  public List<SubstituteMenuItem> createItems(final SubstituteMenuContext context) {
    List<IGrammarActionsDescriptor> descriptors = GrammarCellsUtil.getVisibleDescriptors(context.getModel());
    if (descriptors == null) {
      return Collections.<SubstituteMenuItem>emptyList();
    }
    final SAbstractConcept expectedOutputConcept = getExpectedOutputConcept();
    return ListSequence.fromList(descriptors).translate((it) -> it.getActions(context, expectedOutputConcept)).toList();
  }
}
