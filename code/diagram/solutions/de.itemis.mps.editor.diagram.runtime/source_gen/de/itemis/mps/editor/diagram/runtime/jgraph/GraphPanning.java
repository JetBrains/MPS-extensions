package de.itemis.mps.editor.diagram.runtime.jgraph;

/*Generated by MPS */

import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.awt.Point;
import java.awt.event.MouseEvent;

public class GraphPanning implements MouseListener, MouseMotionListener {

  public static void install(MyGraphComponent graphComponent) {
    new GraphPanning(graphComponent);
  }

  private MyGraphComponent myGraphComponent;
  private Point previousPoint;

  public GraphPanning(MyGraphComponent graphComponent) {
    myGraphComponent = graphComponent;
    myGraphComponent.getGraphControl().addMouseListener(this);
    myGraphComponent.getGraphControl().addMouseMotionListener(this);
  }

  public void mouseDragged(MouseEvent event) {
    if (!(event.isConsumed())) {
      update(event.getPoint());
      event.consume();
    }
  }

  public void mouseMoved(MouseEvent event) {
    if (!(event.isConsumed())) {
      update(event.getPoint());
      event.consume();
    }
  }

  public void mousePressed(MouseEvent event) {
    if (!(event.isConsumed()) && !(event.isPopupTrigger())) {
      start(event.getPoint());
      event.consume();
    }
  }

  public void mouseReleased(MouseEvent event) {
    if (!(event.isConsumed())) {
      stop();
      event.consume();
    }
  }

  public void start(Point point) {
    previousPoint = point;

  }

  public void stop() {
    previousPoint = null;
  }

  public void update(Point point) {
    if (previousPoint == null) {
      return;
    }

    MyGraphView view = myGraphComponent.getGraph().getView();
    double scale = view.getScale();
    de.itemis.mps.editor.diagram.runtime.model.Point translate = VectorExtensions.toPoint(view.getTranslate());
    translate = translate.add(new de.itemis.mps.editor.diagram.runtime.model.Point((point.getX() - previousPoint.getX()) / scale, (point.getY() - previousPoint.getY()) / scale));
    myGraphComponent.scaleAndTranslate(scale, translate.getX(), translate.getY());

    previousPoint = point;
  }

  public void mouseClicked(MouseEvent event) {
  }
  public void mouseEntered(MouseEvent event) {
  }
  public void mouseExited(MouseEvent event) {
  }
}
