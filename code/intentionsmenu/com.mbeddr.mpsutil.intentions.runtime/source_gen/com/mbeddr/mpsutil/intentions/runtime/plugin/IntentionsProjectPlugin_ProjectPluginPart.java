package com.mbeddr.mpsutil.intentions.runtime.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ProjectPluginPart;
import jetbrains.mps.openapi.editor.extensions.EditorExtension;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.openapi.editor.EditorComponent;
import de.slisson.mps.reflection.runtime.ReflectionUtil;
import com.mbeddr.mpsutil.intentions.runtime.MyIntentionsSupport;
import com.mbeddr.mpsutil.intentions.runtime.ActionIntentionMenuProducer;
import jetbrains.mps.nodeEditor.IntentionsSupport;
import jetbrains.mps.editor.intentions.IntentionMenuProducer;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.openapi.editor.extensions.EditorExtensionRegistry;

public class IntentionsProjectPlugin_ProjectPluginPart extends ProjectPluginPart {
  private EditorExtension customIntentionsSupportExtension = new EditorExtension() {
    @Override
    public boolean isApplicable(@NotNull EditorComponent editorComponent) {
      return ((Boolean) ReflectionUtil.callMethod(jetbrains.mps.nodeEditor.EditorComponent.class, ((jetbrains.mps.nodeEditor.EditorComponent) editorComponent), "hasUI", new Class[]{}, new Object[]{}));
    }

    @Override
    public void install(@NotNull EditorComponent openapiEditorComponent) {
      if (!(openapiEditorComponent instanceof jetbrains.mps.nodeEditor.EditorComponent)) {
        return;
      }

      jetbrains.mps.nodeEditor.EditorComponent internalEditorComponent = ((jetbrains.mps.nodeEditor.EditorComponent) openapiEditorComponent);
      if (!((Boolean) ReflectionUtil.callMethod(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "hasUI", new Class[]{}, new Object[]{}))) {
        return;
      }

      ReflectionUtil.writeField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport", new MyIntentionsSupport(internalEditorComponent));
      internalEditorComponent.setIntentionMenuProducer(new ActionIntentionMenuProducer(internalEditorComponent));
    }

    @Override
    public void uninstall(@NotNull EditorComponent openapiEditorComponent) {
      if (!(openapiEditorComponent instanceof jetbrains.mps.nodeEditor.EditorComponent)) {
        return;
      }

      jetbrains.mps.nodeEditor.EditorComponent internalEditorComponent = (jetbrains.mps.nodeEditor.EditorComponent) openapiEditorComponent;
      if (!(((IntentionsSupport) ReflectionUtil.readField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport")) instanceof MyIntentionsSupport)) {
        return;
      }

      ReflectionUtil.writeField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport", new IntentionsSupport(internalEditorComponent));
      internalEditorComponent.setIntentionMenuProducer(new IntentionMenuProducer(internalEditorComponent));
    }
  };
  public IntentionsProjectPlugin_ProjectPluginPart() {
  }
  @Override
  public void init(MPSProject project) {
    project.getComponent(EditorExtensionRegistry.class).registerExtension(IntentionsProjectPlugin_ProjectPluginPart.this.customIntentionsSupportExtension);
  }
  @Override
  public void dispose(MPSProject project) {
    project.getComponent(EditorExtensionRegistry.class).unregisterExtension(IntentionsProjectPlugin_ProjectPluginPart.this.customIntentionsSupportExtension);
  }
}
