package com.mbeddr.mpsutil.intentions.runtime.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ApplicationPluginPart;
import jetbrains.mps.openapi.editor.extensions.EditorExtension;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.openapi.editor.EditorComponent;
import de.slisson.mps.reflection.runtime.ReflectionUtil;
import com.mbeddr.mpsutil.intentions.runtime.MyIntentionsSupport;
import com.mbeddr.mpsutil.intentions.runtime.ActionIntentionMenuProducer;
import jetbrains.mps.nodeEditor.IntentionsSupport;
import jetbrains.mps.editor.intentions.IntentionMenuProducer;
import jetbrains.mps.openapi.editor.extensions.EditorExtensionRegistry;

public class IntentionsPlugin_AppPluginPart extends ApplicationPluginPart {
  private EditorExtension customIntentionsSupportExtension = new EditorExtension() {
    @Override
    public boolean isApplicable(@NotNull EditorComponent editorComponent) {
      return editorComponent instanceof jetbrains.mps.nodeEditor.EditorComponent && ((Boolean) ReflectionUtil.callMethod(jetbrains.mps.nodeEditor.EditorComponent.class, ((jetbrains.mps.nodeEditor.EditorComponent) editorComponent), "hasUI", new Class[]{}, new Object[]{}));
    }

    @Override
    public void install(@NotNull EditorComponent openapiEditorComponent) {
      if (!(openapiEditorComponent instanceof jetbrains.mps.nodeEditor.EditorComponent)) {
        return;
      }

      jetbrains.mps.nodeEditor.EditorComponent internalEditorComponent = ((jetbrains.mps.nodeEditor.EditorComponent) openapiEditorComponent);
      if (!((Boolean) ReflectionUtil.callMethod(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "hasUI", new Class[]{}, new Object[]{}))) {
        return;
      }

      ReflectionUtil.writeField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport", new MyIntentionsSupport(internalEditorComponent));
      internalEditorComponent.setIntentionMenuProducer(new ActionIntentionMenuProducer(internalEditorComponent));
    }

    @Override
    public void uninstall(@NotNull EditorComponent openapiEditorComponent) {
      if (!(openapiEditorComponent instanceof jetbrains.mps.nodeEditor.EditorComponent)) {
        return;
      }

      jetbrains.mps.nodeEditor.EditorComponent internalEditorComponent = (jetbrains.mps.nodeEditor.EditorComponent) openapiEditorComponent;
      if (!(((IntentionsSupport) ReflectionUtil.readField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport")) instanceof MyIntentionsSupport)) {
        return;
      }

      ReflectionUtil.writeField(jetbrains.mps.nodeEditor.EditorComponent.class, internalEditorComponent, "myIntentionsSupport", new IntentionsSupport(internalEditorComponent));
      internalEditorComponent.setIntentionMenuProducer(new IntentionMenuProducer(internalEditorComponent));
    }
  };
  public IntentionsPlugin_AppPluginPart() {
  }
  @Override
  public void init() {
    EditorExtension extension = IntentionsPlugin_AppPluginPart.this.customIntentionsSupportExtension;
    check_l1imn1_a1a0(getPlatform().findComponent(EditorExtensionRegistry.class), extension);
  }
  @Override
  public void dispose() {
    EditorExtension extension = IntentionsPlugin_AppPluginPart.this.customIntentionsSupportExtension;
    check_l1imn1_a1a0_0(getPlatform().findComponent(EditorExtensionRegistry.class), extension);
  }
  private static void check_l1imn1_a1a0(EditorExtensionRegistry checkedDotOperand, EditorExtension extension) {
    if (null != checkedDotOperand) {
      checkedDotOperand.registerExtension(extension);
    }

  }
  private static void check_l1imn1_a1a0_0(EditorExtensionRegistry checkedDotOperand, EditorExtension extension) {
    if (null != checkedDotOperand) {
      checkedDotOperand.unregisterExtension(extension);
    }

  }
}
