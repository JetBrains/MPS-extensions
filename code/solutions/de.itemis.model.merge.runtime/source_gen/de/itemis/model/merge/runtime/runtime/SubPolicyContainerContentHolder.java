package de.itemis.model.merge.runtime.runtime;

/*Generated by MPS */

import java.util.Set;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import de.itemis.model.merge.behavior.MergeAction__BehaviorDescriptor;
import org.apache.commons.lang3.builder.ToStringBuilder;
import org.apache.commons.lang3.builder.ToStringStyle;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public class SubPolicyContainerContentHolder<C> implements ContentHolder<C> {

  public Set<SNode> spcs;
  public SAbstractConcept inheritedFrom;
  private final C content;

  public SubPolicyContainerContentHolder(C content, Set<SNode> s, SAbstractConcept inhf) {
    this.spcs = s;
    this.inheritedFrom = inhf;
    this.content = content;
  }

  @Override
  public boolean isSame(ContentHolder otherStuff) {
    if (otherStuff instanceof SubPolicyContainerContentHolder) {
      SubPolicyContainerContentHolder<C> other = ((SubPolicyContainerContentHolder<C>) otherStuff);
      if (SetSequence.fromSet(this.spcs).count() != SetSequence.fromSet(other.spcs).count()) {
        return false;
      }
      for (final SNode spc : SetSequence.fromSet(this.spcs)) {
        if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(spc, LINKS.action$nr8l), CONCEPTS.ManualAction$CG)) {
          return false;
        }
        SNode otherSpc = SetSequence.fromSet(other.spcs).findFirst((it) -> Objects.equals(SPropertyOperations.getEnum(it, PROPS.subPolicy$jBml), SPropertyOperations.getEnum(spc, PROPS.subPolicy$jBml)));
        if ((otherSpc == null)) {
          return false;
        }
        if (!((boolean) MergeAction__BehaviorDescriptor.isSame_id3EHNiwzfqGd.invoke(SLinkOperations.getTarget(spc, LINKS.action$nr8l), SLinkOperations.getTarget(otherSpc, LINKS.action$nr8l)))) {
          return false;
        }
      }
      return true;
    }
    return false;
  }
  @Override
  public SAbstractConcept inheritedFrom() {
    return this.inheritedFrom;
  }


  @Override
  public String toString() {
    return new ToStringBuilder(this, ToStringStyle.MULTI_LINE_STYLE).append("SubPolicyContainer", spcs).append("inheritedFrom", inheritedFrom).toString();
  }
  @Override
  public C content() {
    return this.content;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink action$nr8l = MetaAdapterFactory.getContainmentLink(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1ed6b4fde1c3243aL, 0x1ed6b4fde1c4a617L, "action");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ManualAction$CG = MetaAdapterFactory.getConcept(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1cd0c633f52d547bL, "de.itemis.model.merge.structure.ManualAction");
  }

  private static final class PROPS {
    /*package*/ static final SProperty subPolicy$jBml = MetaAdapterFactory.getProperty(0x539e893908ef497cL, 0xa5fd25dd10137a55L, 0x1ed6b4fde1c3243aL, 0x1ed6b4fde1c3243bL, "subPolicy");
  }
}
