package de.q60.mps.incremental.runtime;

/*Generated by MPS */

import jetbrains.mps.internal.collections.runtime.Sequence;

public class TrackableValue<E> extends DependencyKey {

  private E value;
  private boolean frozen = false;

  public TrackableValue(E initialValue) {
    value = initialValue;
  }

  public void set(E value) {
    if (frozen) {
      throw new RuntimeException("Value is frozen");
    }
    this.value = value;
    DependencyBroadcaster.INSTANCE.dependenciesChanged(Sequence.<DependencyKey>singleton(this));
  }

  public E get() {
    if (!(frozen)) {
      DependencyBroadcaster.INSTANCE.dependencyAccessed(this);
    }
    return value;
  }

  public void freeze() {
    frozen = true;
    DependencyBroadcaster.INSTANCE.dependenciesChanged(Sequence.<DependencyKey>singleton(this));
  }
}
