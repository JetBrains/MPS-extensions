package nl.f1re.testing.runtime;

/*Generated by MPS */

import java.time.Duration;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.checkers.IChecker;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.errors.item.NodeReportItem;
import jetbrains.mps.project.validation.StructureChecker;
import jetbrains.mps.checkers.IAbstractChecker;
import jetbrains.mps.checkers.ModelCheckerBuilder;
import jetbrains.mps.errors.item.IssueKindReportItem;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.util.CollectConsumer;
import jetbrains.mps.progress.EmptyProgressMonitor;

public class TypesystemTestUtil {

  public static Duration measureTypesystemPerformance(SModel model) {
    IChecker<SNode, NodeReportItem> structureChecker = new StructureChecker();
    long startTime = System.nanoTime();
    IAbstractChecker<ModelCheckerBuilder.ItemsToCheck, IssueKindReportItem> checker = new ModelCheckerBuilder(new ModelCheckerBuilder.ModelsExtractorImpl().includeStubs(false)).createChecker(ListSequence.fromListAndArray(new ArrayList<IChecker<?, ? extends IssueKindReportItem>>(), structureChecker));
    checker.check(ModelCheckerBuilder.ItemsToCheck.forSingleModel(model), model.getRepository(), new CollectConsumer<IssueKindReportItem>(), new EmptyProgressMonitor());
    long stopTime = System.nanoTime();
    return Duration.ofNanos(stopTime - startTime);
  }
}
