package de.itemis.mps.changelog.intentions;

/*Generated by MPS */

import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionFactory;
import java.util.List;
import de.itemis.mps.selection.runtime.intentions.ISelectionIntentionExecutable;
import jetbrains.mps.lang.text.editor.WordRangeSelection;
import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionExecutable;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Collections;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class CombineElements extends AbstractSelectionIntentionFactory {
  public CombineElements() {
  }

  @Override
  public List<ISelectionIntentionExecutable> getInstances(Object selection) {
    if (selection instanceof WordRangeSelection) {
      ISelectionIntentionExecutable intention = new AbstractSelectionIntentionExecutable<WordRangeSelection>() {
        @Override
        public void execute(WordRangeSelection selection) {
          List<SNode> selectedNodes = selection.getSelectedNodes();
          List<SNode> selectedElements = ListSequence.fromList(selectedNodes).select((it) -> SNodeOperations.as(it, CONCEPTS.TextElement$WN)).toList();
          SNode newWord = createCombinedElements_hmrw63_a0c0a(ListSequence.fromList(selectedElements).select((it) -> SNodeOperations.copyNode(it)));
          SNodeOperations.replaceWithAnother(ListSequence.fromList(selectedElements).first(), newWord);
          ListSequence.fromList(selectedElements).skip(1).visitAll((it) -> SNodeOperations.deleteNode(it));
          selection.getEditorComponent().getEditorContext().selectWRTFocusPolicy(newWord);
        }
        @Override
        public String getDescription(WordRangeSelection selection) {
          return "Combine Multiple Elements Without Spaces";
        }
        @Override
        public boolean isApplicable(WordRangeSelection selection) {
          List<SNode> selectedNodes = selection.getSelectedNodes();
          return ListSequence.fromList(selectedNodes).all((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.TextElement$WN)) && ListSequence.fromList(selectedNodes).count() > 1;
        }
      };
      return Collections.singletonList(intention);
    } else {
      return Collections.<ISelectionIntentionExecutable>emptyList();
    }
  }
  private static SNode createCombinedElements_hmrw63_a0c0a(Iterable<? extends SNode> p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.CombinedElements$P9);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.line$6dQe).init(CONCEPTS.Line$yC);
      n1.forChild(LINKS.elements$_j45).initNodeList(p0, CONCEPTS.TextElement$WN);
    }
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TextElement$WN = MetaAdapterFactory.getConcept(0xc7fb639fbe784307L, 0x89b0b5959c3fa8c8L, 0x229012ddae35ee7L, "jetbrains.mps.lang.text.structure.TextElement");
    /*package*/ static final SConcept CombinedElements$P9 = MetaAdapterFactory.getConcept(0x638c9345261349dcL, 0xb2ae8ceadef24141L, 0x19305fca8873d0a5L, "de.itemis.mps.changelog.structure.CombinedElements");
    /*package*/ static final SConcept Line$yC = MetaAdapterFactory.getConcept(0xc7fb639fbe784307L, 0x89b0b5959c3fa8c8L, 0x2331694e561af166L, "jetbrains.mps.lang.text.structure.Line");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink line$6dQe = MetaAdapterFactory.getContainmentLink(0x638c9345261349dcL, 0xb2ae8ceadef24141L, 0x19305fca8873d0a5L, 0x19305fca887ae36eL, "line");
    /*package*/ static final SContainmentLink elements$_j45 = MetaAdapterFactory.getContainmentLink(0xc7fb639fbe784307L, 0x89b0b5959c3fa8c8L, 0x2331694e561af166L, 0x2331694e561af167L, "elements");
  }
}
